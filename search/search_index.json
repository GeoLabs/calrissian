{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Calrissian","text":"<p>CWL on Kubernetes</p>"},{"location":"#overview","title":"Overview","text":"<p>Calrissian is a CWL implementation designed to run inside a Kubernetes cluster. Its goal is to be highly efficient and scalable, taking advantage of high capacity clusters to run many steps in parallel.</p>"},{"location":"#cluster-requirements","title":"Cluster Requirements","text":"<p>Calrissian requires a Kubernetes cluster, configured to provision PersistentVolumes with the ReadWriteMany access mode. </p>"},{"location":"#scalability-resource-requirements","title":"Scalability / Resource Requirements","text":"<p>Calrissian is designed to issue tasks in parallel if they are independent, and thanks to Kubernetes, should be able to run very large parallel workloads.</p> <p>When running <code>calrissian</code>, you must provide a limit the the number of CPU cores (<code>--max-cores</code>) and RAM megabytes (<code>--max-ram</code>) to use concurrently. Calrissian will use CWL ResourceRequirements to track usage and stay within the limits provided. We highly recommend using accurate ResourceRequirements in your workloads, so that they can be scheduled efficiently and are less likely to be terminated or refused by the cluster.</p>"},{"location":"cluster-configuration/","title":"Cluster Configuration","text":""},{"location":"cluster-configuration/#creating-namespace-and-roles","title":"Creating Namespace and Roles","text":"<p><code>calrissian</code> executes CWL workflows by running steps as Pods in a kubernetes cluster. </p> <p>To support this requirement, we create a role with the necessary privileges and bind it to a service account.</p>"},{"location":"cluster-configuration/#create-the-namespace","title":"Create the Namespace","text":"<pre><code>NAMESPACE_NAME=calrissian-demo-project\nkubectl create namespace \"$NAMESPACE_NAME\"\n</code></pre>"},{"location":"cluster-configuration/#create-the-roles-and-rolebindings","title":"Create the Roles and RoleBindings","text":"<pre><code>kubectl --namespace=\"$NAMESPACE_NAME\" create role pod-manager-role \\\n  --verb=create,patch,delete,list,watch --resource=pods\nkubectl --namespace=\"$NAMESPACE_NAME\" create role log-reader-role \\\n  --verb=get,list --resource=pods/log\nkubectl --namespace=\"$NAMESPACE_NAME\" create rolebinding pod-manager-default-binding \\\n  --role=pod-manager-role --serviceaccount=${NAMESPACE_NAME}:default\nkubectl --namespace=\"$NAMESPACE_NAME\" create rolebinding log-reader-default-binding \\\n  --role=log-reader-role --serviceaccount=${NAMESPACE_NAME}:default\n</code></pre>"},{"location":"installation/","title":"Installation","text":""},{"location":"installation/#installation","title":"Installation","text":"<p>Calrissian is available at: https://pypi.org/project/calrissian/</p> <p>Install it with:</p> <pre><code>pip install calrissian\n</code></pre>"},{"location":"api/latest/calrissian/","title":"Module calrissian","text":""},{"location":"api/latest/calrissian/#sub-modules","title":"Sub-modules","text":"<ul> <li>calrissian.context</li> <li>calrissian.dask</li> <li>calrissian.executor</li> <li>calrissian.job</li> <li>calrissian.k8s</li> <li>calrissian.main</li> <li>calrissian.report</li> <li>calrissian.retry</li> <li>calrissian.tool</li> <li>calrissian.version</li> </ul>"},{"location":"api/latest/calrissian/context/","title":"Module calrissian.context","text":""},{"location":"api/latest/calrissian/context/#variables","title":"Variables","text":"<pre><code>log\n</code></pre>"},{"location":"api/latest/calrissian/context/#classes","title":"Classes","text":""},{"location":"api/latest/calrissian/context/#calrissianloadingcontext","title":"CalrissianLoadingContext","text":"<pre><code>class CalrissianLoadingContext(\n    **kwargs\n)\n</code></pre> <p>Shared kwargs based initializer for :py:class:<code>RuntimeContext</code> and :py:class:<code>LoadingContext</code>.</p>"},{"location":"api/latest/calrissian/context/#ancestors-in-mro","title":"Ancestors (in MRO)","text":"<ul> <li>cwltool.context.LoadingContext</li> <li>cwltool.context.ContextBase</li> </ul>"},{"location":"api/latest/calrissian/context/#methods","title":"Methods","text":""},{"location":"api/latest/calrissian/context/#copy","title":"copy","text":"<pre><code>def copy(\n    self\n) -&gt; 'LoadingContext'\n</code></pre> <p>Return a copy of this :py:class:<code>LoadingContext</code>.</p>"},{"location":"api/latest/calrissian/context/#calrissianruntimecontext","title":"CalrissianRuntimeContext","text":"<pre><code>class CalrissianRuntimeContext(\n    kwargs=None\n)\n</code></pre> <p>Shared kwargs based initializer for :py:class:<code>RuntimeContext</code> and :py:class:<code>LoadingContext</code>.</p>"},{"location":"api/latest/calrissian/context/#ancestors-in-mro_1","title":"Ancestors (in MRO)","text":"<ul> <li>cwltool.context.RuntimeContext</li> <li>cwltool.context.ContextBase</li> </ul>"},{"location":"api/latest/calrissian/context/#class-variables","title":"Class variables","text":"<pre><code>outdir\n</code></pre> <pre><code>stagedir\n</code></pre> <pre><code>tmp_outdir_prefix\n</code></pre> <pre><code>tmpdir\n</code></pre> <pre><code>tmpdir_prefix\n</code></pre>"},{"location":"api/latest/calrissian/context/#methods_1","title":"Methods","text":""},{"location":"api/latest/calrissian/context/#copy_1","title":"copy","text":"<pre><code>def copy(\n    self\n) -&gt; 'RuntimeContext'\n</code></pre> <p>Return a copy of this :py:class:<code>RuntimeContext</code>.</p>"},{"location":"api/latest/calrissian/context/#create_outdir","title":"create_outdir","text":"<pre><code>def create_outdir(\n    self\n) -&gt; str\n</code></pre> <p>Create a temporary directory that respects :py:attr:<code>tmp_outdir_prefix</code>.</p>"},{"location":"api/latest/calrissian/context/#create_tmpdir","title":"create_tmpdir","text":"<pre><code>def create_tmpdir(\n    self\n) -&gt; str\n</code></pre> <p>Create a temporary directory that respects :py:attr:<code>tmpdir_prefix</code>.</p>"},{"location":"api/latest/calrissian/context/#get_outdir","title":"get_outdir","text":"<pre><code>def get_outdir(\n    self\n) -&gt; str\n</code></pre> <p>Return :py:attr:<code>outdir</code> or create one with :py:attr:<code>tmp_outdir_prefix</code>.</p>"},{"location":"api/latest/calrissian/context/#get_stagedir","title":"get_stagedir","text":"<pre><code>def get_stagedir(\n    self\n) -&gt; str\n</code></pre> <p>Return :py:attr:<code>stagedir</code> or create one with :py:attr:<code>tmpdir_prefix</code>.</p>"},{"location":"api/latest/calrissian/context/#get_tmpdir","title":"get_tmpdir","text":"<pre><code>def get_tmpdir(\n    self\n) -&gt; str\n</code></pre> <p>Return :py:attr:<code>tmpdir</code> or create one with :py:attr:<code>tmpdir_prefix</code>.</p>"},{"location":"api/latest/calrissian/dask/","title":"Module calrissian.dask","text":""},{"location":"api/latest/calrissian/dask/#variables","title":"Variables","text":"<pre><code>DEFAULT_INIT_IMAGE\n</code></pre> <pre><code>INIT_IMAGE_ENV_VARIABLE\n</code></pre> <pre><code>log\n</code></pre> <pre><code>log_main\n</code></pre>"},{"location":"api/latest/calrissian/dask/#functions","title":"Functions","text":""},{"location":"api/latest/calrissian/dask/#dask_req_validate","title":"dask_req_validate","text":"<pre><code>def dask_req_validate(\n    requirement: Optional[collections.abc.MutableMapping[str, Union[NoneType, bool, str, int, float, collections.abc.MutableSequence['CWLOutputType'], collections.abc.MutableMapping[str, 'CWLOutputType']]]]\n) -&gt; bool\n</code></pre> <p>Check if CWL ext DaskGatewayRequirements has all the required keys</p> <ul> <li>If a key is missing return False.</li> <li>Otherwise, return True.</li> </ul>"},{"location":"api/latest/calrissian/dask/#classes","title":"Classes","text":""},{"location":"api/latest/calrissian/dask/#calrissiancommandlinedaskjob","title":"CalrissianCommandLineDaskJob","text":"<pre><code>class CalrissianCommandLineDaskJob(\n    *args,\n    **kwargs\n)\n</code></pre> <p>Commandline job using containers.</p>"},{"location":"api/latest/calrissian/dask/#ancestors-in-mro","title":"Ancestors (in MRO)","text":"<ul> <li>calrissian.job.CalrissianCommandLineJob</li> <li>cwltool.job.ContainerCommandLineJob</li> <li>cwltool.job.JobBase</li> <li>cwltool.utils.HasReqsHints</li> </ul>"},{"location":"api/latest/calrissian/dask/#class-variables","title":"Class variables","text":"<pre><code>CONTAINER_TMPDIR\n</code></pre> <pre><code>container_shared_dir\n</code></pre> <pre><code>container_tmpdir\n</code></pre> <pre><code>dask_gateway_config_dir\n</code></pre> <pre><code>dask_gateway_controller_dir\n</code></pre> <pre><code>supported_features\n</code></pre>"},{"location":"api/latest/calrissian/dask/#static-methods","title":"Static methods","text":""},{"location":"api/latest/calrissian/dask/#extract_environment","title":"extract_environment","text":"<pre><code>def extract_environment(\n    runtimeContext: cwltool.context.RuntimeContext,\n    envVarReq: collections.abc.Mapping[str, str]\n) -&gt; collections.abc.Mapping[str, str]\n</code></pre> <p>Extract environment variables that should be preserved.</p>"},{"location":"api/latest/calrissian/dask/#methods","title":"Methods","text":""},{"location":"api/latest/calrissian/dask/#add_file_or_directory_volume","title":"add_file_or_directory_volume","text":"<pre><code>def add_file_or_directory_volume(\n    self,\n    runtime,\n    volume,\n    host_outdir_tgt\n)\n</code></pre> <p>Append volume a file/dir mapping to the runtime option list.</p>"},{"location":"api/latest/calrissian/dask/#add_volumes","title":"add_volumes","text":"<pre><code>def add_volumes(\n    self,\n    pathmapper: cwltool.pathmapper.PathMapper,\n    runtime: list[str],\n    tmpdir_prefix: str,\n    secret_store: cwltool.secrets.SecretStore | None = None,\n    any_path_okay: bool = False\n) -&gt; None\n</code></pre> <p>Append volume mappings to the runtime option list.</p>"},{"location":"api/latest/calrissian/dask/#add_writable_directory_volume","title":"add_writable_directory_volume","text":"<pre><code>def add_writable_directory_volume(\n    self,\n    runtime,\n    volume,\n    host_outdir_tgt,\n    tmpdir_prefix\n)\n</code></pre> <p>Append a writable directory mapping to the runtime option list.</p>"},{"location":"api/latest/calrissian/dask/#add_writable_file_volume","title":"add_writable_file_volume","text":"<pre><code>def add_writable_file_volume(\n    self,\n    runtime,\n    volume,\n    host_outdir_tgt,\n    tmpdir_prefix\n)\n</code></pre> <p>Append a writable file mapping to the runtime option list.</p>"},{"location":"api/latest/calrissian/dask/#append_volume","title":"append_volume","text":"<pre><code>def append_volume(\n    self,\n    runtime,\n    source,\n    target,\n    writable=False\n)\n</code></pre> <p>Add volume binding to the arguments list.</p> <p>This is called by the base class for file literals after they've been created. We already have a similar function, so we just call that.</p>"},{"location":"api/latest/calrissian/dask/#check_requirements","title":"check_requirements","text":"<pre><code>def check_requirements(\n    self,\n    runtimeContext\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#create_file_and_add_volume","title":"create_file_and_add_volume","text":"<pre><code>def create_file_and_add_volume(\n    self,\n    runtime: list[str],\n    volume: cwltool.pathmapper.MapperEnt,\n    host_outdir_tgt: str | None,\n    secret_store: cwltool.secrets.SecretStore | None,\n    tmpdir_prefix: str\n) -&gt; str\n</code></pre> <p>Create the file and add a mapping.</p>"},{"location":"api/latest/calrissian/dask/#create_kubernetes_runtime","title":"create_kubernetes_runtime","text":"<pre><code>def create_kubernetes_runtime(\n    self,\n    runtimeContext\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#create_runtime","title":"create_runtime","text":"<pre><code>def create_runtime(\n    self,\n    env,\n    runtime_context\n)\n</code></pre> <p>Return the list of commands to run the selected container engine.</p>"},{"location":"api/latest/calrissian/dask/#dask_configmap_name","title":"dask_configmap_name","text":"<pre><code>def dask_configmap_name(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#docker_monitor","title":"docker_monitor","text":"<pre><code>def docker_monitor(\n    self,\n    cidfile: str,\n    tmpdir_prefix: str,\n    cleanup_cidfile: bool,\n    docker_exe: str,\n    process: 'subprocess.Popen[str]'\n) -&gt; None\n</code></pre> <p>Record memory usage of the running Docker container.</p>"},{"location":"api/latest/calrissian/dask/#dump_tool_logs","title":"dump_tool_logs","text":"<pre><code>def dump_tool_logs(\n    self,\n    name,\n    completion_result: calrissian.k8s.CompletionResult,\n    runtime_context\n)\n</code></pre> <p>Dumps the tool logs</p>"},{"location":"api/latest/calrissian/dask/#execute_kubernetes_pod","title":"execute_kubernetes_pod","text":"<pre><code>def execute_kubernetes_pod(\n    self,\n    pod\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#finish","title":"finish","text":"<pre><code>def finish(\n    self,\n    completion_result: calrissian.k8s.CompletionResult,\n    runtimeContext\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#get_dask_gateway_url","title":"get_dask_gateway_url","text":"<pre><code>def get_dask_gateway_url(\n    self,\n    runtimeContext\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#get_dask_script_cm_name","title":"get_dask_script_cm_name","text":"<pre><code>def get_dask_script_cm_name(\n    self,\n    runtimeContext\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#get_from_requirements","title":"get_from_requirements","text":"<pre><code>def get_from_requirements(\n    self,\n    r,\n    pull_image,\n    force_pull=False,\n    tmp_outdir_prefix='/tmp/'\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#get_network_access_pod_labels","title":"get_network_access_pod_labels","text":"<pre><code>def get_network_access_pod_labels(\n    self,\n    runtimeContext\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#get_no_network_access_pod_labels","title":"get_no_network_access_pod_labels","text":"<pre><code>def get_no_network_access_pod_labels(\n    self,\n    runtimeContext\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#get_pod_additional_spec","title":"get_pod_additional_spec","text":"<pre><code>def get_pod_additional_spec(\n    self,\n    runtimeContext\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#get_pod_env_from_configmap","title":"get_pod_env_from_configmap","text":"<pre><code>def get_pod_env_from_configmap(\n    self,\n    runtimeContext\n) -&gt; list\n</code></pre>"},{"location":"api/latest/calrissian/dask/#get_pod_env_from_secret","title":"get_pod_env_from_secret","text":"<pre><code>def get_pod_env_from_secret(\n    self,\n    runtimeContext\n) -&gt; list\n</code></pre>"},{"location":"api/latest/calrissian/dask/#get_pod_env_vars","title":"get_pod_env_vars","text":"<pre><code>def get_pod_env_vars(\n    self,\n    runtimeContext\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#get_pod_gpu_nodeselectors","title":"get_pod_gpu_nodeselectors","text":"<pre><code>def get_pod_gpu_nodeselectors(\n    self,\n    runtimeContext\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#get_pod_labels","title":"get_pod_labels","text":"<pre><code>def get_pod_labels(\n    self,\n    runtimeContext\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#get_pod_nodeselectors","title":"get_pod_nodeselectors","text":"<pre><code>def get_pod_nodeselectors(\n    self,\n    runtimeContext\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#get_pod_priority_class","title":"get_pod_priority_class","text":"<pre><code>def get_pod_priority_class(\n    self,\n    runtimeContext\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#get_pod_serviceaccount","title":"get_pod_serviceaccount","text":"<pre><code>def get_pod_serviceaccount(\n    self,\n    runtimeContext\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#get_requirement","title":"get_requirement","text":"<pre><code>def get_requirement(\n    self,\n    feature: str\n) -&gt; tuple[collections.abc.MutableMapping[str, typing.Union[NoneType, bool, str, int, float, collections.abc.MutableSequence['CWLOutputType'], collections.abc.MutableMapping[str, 'CWLOutputType']]] | None, bool | None]\n</code></pre> <p>Retrieve the named feature from the requirements field, or the hints field.</p>"},{"location":"api/latest/calrissian/dask/#get_security_context","title":"get_security_context","text":"<pre><code>def get_security_context(\n    self,\n    runtimeContext\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#make_tmpdir","title":"make_tmpdir","text":"<pre><code>def make_tmpdir(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#populate_env_vars","title":"populate_env_vars","text":"<pre><code>def populate_env_vars(\n    self,\n    runtimeContext\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#prepare_environment","title":"prepare_environment","text":"<pre><code>def prepare_environment(\n    self,\n    runtimeContext: cwltool.context.RuntimeContext,\n    envVarReq: collections.abc.Mapping[str, str]\n) -&gt; None\n</code></pre> <p>Set up environment variables.</p> <p>Here we prepare the environment for the job, based on any preserved variables and <code>EnvVarRequirement</code>. Later, changes due to <code>MPIRequirement</code>, <code>Secrets</code>, or <code>SoftwareRequirement</code> are applied (in that order).</p>"},{"location":"api/latest/calrissian/dask/#process_monitor","title":"process_monitor","text":"<pre><code>def process_monitor(\n    self,\n    sproc: 'subprocess.Popen[str]'\n) -&gt; None\n</code></pre> <p>Watch a process, logging its max memory usage.</p>"},{"location":"api/latest/calrissian/dask/#quoted_command_line","title":"quoted_command_line","text":"<pre><code>def quoted_command_line(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#report","title":"report","text":"<pre><code>def report(\n    self,\n    completion_result: calrissian.k8s.CompletionResult,\n    disk_bytes\n)\n</code></pre> <p>Convert the k8s-specific completion result into a report and submit it</p> <p>Parameters:</p> Name Type Description Default completion_result None calrissian.k8s.CompletionResult None"},{"location":"api/latest/calrissian/dask/#run","title":"run","text":"<pre><code>def run(\n    self,\n    runtimeContext,\n    tmpdir_lock=None\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#setup_kubernetes","title":"setup_kubernetes","text":"<pre><code>def setup_kubernetes(\n    self,\n    runtime_context\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#wait_for_kubernetes_pod","title":"wait_for_kubernetes_pod","text":"<pre><code>def wait_for_kubernetes_pod(\n    self,\n    cm_name: Optional[str] = None\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#daskpodmonitor","title":"DaskPodMonitor","text":"<pre><code>class DaskPodMonitor(\n\n)\n</code></pre> <p>This class is designed to track pods submitted by KubernetesClient across different background threads,</p> <p>and provide a static cleanup() method to attempt to delete those pods on termination.</p> <p>Instances of this class are used as context manager, and acquire the shared lock. The add and remove methods should only be called from inside the context block while the lock is acquired.</p> <p>The static cleanup() method also acquires the lock and attempts to delete all outstanding pods.</p>"},{"location":"api/latest/calrissian/dask/#ancestors-in-mro_1","title":"Ancestors (in MRO)","text":"<ul> <li>calrissian.k8s.PodMonitor</li> </ul>"},{"location":"api/latest/calrissian/dask/#class-variables_1","title":"Class variables","text":"<pre><code>lock\n</code></pre> <pre><code>pod_names\n</code></pre>"},{"location":"api/latest/calrissian/dask/#static-methods_1","title":"Static methods","text":""},{"location":"api/latest/calrissian/dask/#cleanup","title":"cleanup","text":"<pre><code>def cleanup(\n\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#methods_1","title":"Methods","text":""},{"location":"api/latest/calrissian/dask/#add","title":"add","text":"<pre><code>def add(\n    self,\n    pod\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#remove","title":"remove","text":"<pre><code>def remove(\n    self,\n    pod\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#kubernetesdaskclient","title":"KubernetesDaskClient","text":"<pre><code>class KubernetesDaskClient(\n\n)\n</code></pre> <p>Instances of this class are created by a <code>calrissian.job.CalrissianCommandLineJob</code>,</p> <p>which are often running in background threads (spawned by <code>calrissian.executor.MultithreadedJobExecutor</code></p> <p>This class uses a PodMonitor to keep track of the pods it submits in a single, shared list. KubernetesClient is responsible for telling PodMonitor after it has submitted a pod and when it knows that pod is terminated. Using PodMonitor as a context manager (with PodMonitor() as p) acquires a lock for thread safety.</p>"},{"location":"api/latest/calrissian/dask/#ancestors-in-mro_2","title":"Ancestors (in MRO)","text":"<ul> <li>calrissian.k8s.KubernetesClient</li> </ul>"},{"location":"api/latest/calrissian/dask/#static-methods_2","title":"Static methods","text":""},{"location":"api/latest/calrissian/dask/#format_log_entry","title":"format_log_entry","text":"<pre><code>def format_log_entry(\n    pod_name,\n    log_entry\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#get_container_by_name","title":"get_container_by_name","text":"<pre><code>def get_container_by_name(\n    container_list: Optional[List[Union[kubernetes.client.models.v1_container_status.V1ContainerStatus, kubernetes.client.models.v1_container.V1Container]]],\n    container_name: str\n) -&gt; Union[kubernetes.client.models.v1_container_status.V1ContainerStatus, kubernetes.client.models.v1_container.V1Container, NoneType]\n</code></pre>"},{"location":"api/latest/calrissian/dask/#get_first_or_none","title":"get_first_or_none","text":"<pre><code>def get_first_or_none(\n    container_list: List[Union[kubernetes.client.models.v1_container_status.V1ContainerStatus, kubernetes.client.models.v1_container.V1Container]]\n) -&gt; Union[kubernetes.client.models.v1_container_status.V1ContainerStatus, kubernetes.client.models.v1_container.V1Container]\n</code></pre> <p>Check the list. Should be 0 or 1 items. If 0, there's no container yet. If 1, there's a</p> <p>container. If &gt; 1, there's more than 1 container and that's unexpected behavior</p> <p>Parameters:</p> Name Type Description Default containers_or_container_statuses None list of V1ContainerStatus or V1Container None <p>Returns:</p> Type Description None first item if len of list is 1, None if 0, and raises CalrissianJobException if &gt; 1"},{"location":"api/latest/calrissian/dask/#get_last_or_none","title":"get_last_or_none","text":"<pre><code>def get_last_or_none(\n    container_list: Optional[List[Union[kubernetes.client.models.v1_container_status.V1ContainerStatus, kubernetes.client.models.v1_container.V1Container]]]\n) -&gt; Union[kubernetes.client.models.v1_container_status.V1ContainerStatus, kubernetes.client.models.v1_container.V1Container, NoneType]\n</code></pre>"},{"location":"api/latest/calrissian/dask/#get_list_or_none","title":"get_list_or_none","text":"<pre><code>def get_list_or_none(\n    container_list: Optional[List[Union[kubernetes.client.models.v1_container_status.V1ContainerStatus, kubernetes.client.models.v1_container.V1Container]]]\n) -&gt; Union[kubernetes.client.models.v1_container_status.V1ContainerStatus, kubernetes.client.models.v1_container.V1Container, NoneType]\n</code></pre>"},{"location":"api/latest/calrissian/dask/#state_is_running","title":"state_is_running","text":"<pre><code>def state_is_running(\n    state\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#state_is_terminated","title":"state_is_terminated","text":"<pre><code>def state_is_terminated(\n    state\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#state_is_waiting","title":"state_is_waiting","text":"<pre><code>def state_is_waiting(\n    state\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#methods_2","title":"Methods","text":""},{"location":"api/latest/calrissian/dask/#create_dask_gateway_config_map","title":"create_dask_gateway_config_map","text":"<pre><code>def create_dask_gateway_config_map(\n    self,\n    dask_gateway_url: str,\n    cm_name: str\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#delete_configmap_name","title":"delete_configmap_name","text":"<pre><code>def delete_configmap_name(\n    self,\n    cm_name\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#delete_pod_name","title":"delete_pod_name","text":"<pre><code>def delete_pod_name(\n    self,\n    pod_name\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#follow_logs","title":"follow_logs","text":"<pre><code>def follow_logs(\n    self,\n    status=None\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#get_configmap_from_namespace","title":"get_configmap_from_namespace","text":"<pre><code>def get_configmap_from_namespace(\n    self,\n    name\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#get_current_pod","title":"get_current_pod","text":"<pre><code>def get_current_pod(\n    self\n)\n</code></pre> <p>Return pod details about the current pod (ie the one we are running inside of).</p> <p>Requires 'CALRISSIAN_POD_NAME' environment variable to be set.</p> <p>Returns:</p> Type Description None V1Pod"},{"location":"api/latest/calrissian/dask/#get_pod_for_name","title":"get_pod_for_name","text":"<pre><code>def get_pod_for_name(\n    self,\n    pod_name\n)\n</code></pre> <p>Given a pod name return details about this pod</p> <p>Parameters:</p> Name Type Description Default pod_name None str: name of the pod to read data about None <p>Returns:</p> Type Description None V1Pod"},{"location":"api/latest/calrissian/dask/#should_delete_pod","title":"should_delete_pod","text":"<pre><code>def should_delete_pod(\n    self\n)\n</code></pre> <p>Decide whether or not to delete a pod. Defaults to True if unset.</p> <p>Checks the CALRISSIAN_DELETE_PODS environment variable</p> <p>Returns:</p> Type Description None"},{"location":"api/latest/calrissian/dask/#submit_pod","title":"submit_pod","text":"<pre><code>def submit_pod(\n    self,\n    pod_body\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#wait_for_completion","title":"wait_for_completion","text":"<pre><code>def wait_for_completion(\n    self,\n    cm_name: str = None\n) -&gt; calrissian.k8s.CompletionResult\n</code></pre>"},{"location":"api/latest/calrissian/dask/#kubernetesdaskpodbuilder","title":"KubernetesDaskPodBuilder","text":"<pre><code>class KubernetesDaskPodBuilder(\n    dask_gateway_url,\n    dask_gateway_controller,\n    *args,\n    **kwargs\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#ancestors-in-mro_3","title":"Ancestors (in MRO)","text":"<ul> <li>calrissian.job.KubernetesPodBuilder</li> </ul>"},{"location":"api/latest/calrissian/dask/#static-methods_3","title":"Static methods","text":""},{"location":"api/latest/calrissian/dask/#resource_type","title":"resource_type","text":"<pre><code>def resource_type(\n    cwl_field\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#resource_value","title":"resource_value","text":"<pre><code>def resource_value(\n    kind,\n    cwl_value\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#methods_3","title":"Methods","text":""},{"location":"api/latest/calrissian/dask/#build","title":"build","text":"<pre><code>def build(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#container_args","title":"container_args","text":"<pre><code>def container_args(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#container_command","title":"container_command","text":"<pre><code>def container_command(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#container_environment","title":"container_environment","text":"<pre><code>def container_environment(\n    self\n)\n</code></pre> <p>Build the environment line for the kubernetes yaml</p> <p>Returns:</p> Type Description None array of env variables to set"},{"location":"api/latest/calrissian/dask/#container_name","title":"container_name","text":"<pre><code>def container_name(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#container_resources","title":"container_resources","text":"<pre><code>def container_resources(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#container_workingdir","title":"container_workingdir","text":"<pre><code>def container_workingdir(\n    self\n)\n</code></pre> <p>Return the working directory for this container</p> <p>Returns:</p> Type Description None"},{"location":"api/latest/calrissian/dask/#init_container_command","title":"init_container_command","text":"<pre><code>def init_container_command(\n    self\n)\n</code></pre> <p>Constructs the command for initializing a Dask cluster.</p>"},{"location":"api/latest/calrissian/dask/#init_container_name","title":"init_container_name","text":"<pre><code>def init_container_name(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#init_containers","title":"init_containers","text":"<pre><code>def init_containers(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#pod_envfromconfigmap","title":"pod_envfromconfigmap","text":"<pre><code>def pod_envfromconfigmap(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#pod_envfromsecret","title":"pod_envfromsecret","text":"<pre><code>def pod_envfromsecret(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#pod_labels","title":"pod_labels","text":"<pre><code>def pod_labels(\n    self\n)\n</code></pre> <p>Submitted labels must be strings</p> <p>Returns:</p> Type Description None"},{"location":"api/latest/calrissian/dask/#pod_name","title":"pod_name","text":"<pre><code>def pod_name(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/dask/#select_pod_nodeselectors","title":"select_pod_nodeselectors","text":"<pre><code>def select_pod_nodeselectors(\n    self\n)\n</code></pre> <p>Return the appropriate Kubernetes node selectors for the pod.</p> <p>If the job requirements include a CUDA requirement (either 'cwltool:CUDARequirement' or 'http://commonwl.org/cwltool#CUDARequirement'), GPU-specific node selectors are used. Otherwise, the default node selectors are returned.</p> <p>Returns:</p> Type Description None A dict of node selector labels (str -&gt; str)"},{"location":"api/latest/calrissian/dask/#sidecar_container_command","title":"sidecar_container_command","text":"<pre><code>def sidecar_container_command(\n    self\n)\n</code></pre> <p>Constructs the command for disposing of a Dask cluster.</p>"},{"location":"api/latest/calrissian/executor/","title":"Module calrissian.executor","text":""},{"location":"api/latest/calrissian/executor/#variables","title":"Variables","text":"<pre><code>ALL_COMPLETED\n</code></pre> <pre><code>FIRST_COMPLETED\n</code></pre> <pre><code>log\n</code></pre>"},{"location":"api/latest/calrissian/executor/#classes","title":"Classes","text":""},{"location":"api/latest/calrissian/executor/#duplicatejobexception","title":"DuplicateJobException","text":"<pre><code>class DuplicateJobException(\n    /,\n    *args,\n    **kwargs\n)\n</code></pre> <p>Common base class for all non-exit exceptions.</p>"},{"location":"api/latest/calrissian/executor/#ancestors-in-mro","title":"Ancestors (in MRO)","text":"<ul> <li>builtins.Exception</li> <li>builtins.BaseException</li> </ul>"},{"location":"api/latest/calrissian/executor/#class-variables","title":"Class variables","text":"<pre><code>args\n</code></pre>"},{"location":"api/latest/calrissian/executor/#methods","title":"Methods","text":""},{"location":"api/latest/calrissian/executor/#with_traceback","title":"with_traceback","text":"<pre><code>def with_traceback(\n    ...\n)\n</code></pre> <p>Exception.with_traceback(tb) --</p> <p>set self.traceback to tb and return self.</p>"},{"location":"api/latest/calrissian/executor/#incompletestatusexception","title":"IncompleteStatusException","text":"<pre><code>class IncompleteStatusException(\n    /,\n    *args,\n    **kwargs\n)\n</code></pre> <p>Common base class for all non-exit exceptions.</p>"},{"location":"api/latest/calrissian/executor/#ancestors-in-mro_1","title":"Ancestors (in MRO)","text":"<ul> <li>builtins.Exception</li> <li>builtins.BaseException</li> </ul>"},{"location":"api/latest/calrissian/executor/#class-variables_1","title":"Class variables","text":"<pre><code>args\n</code></pre>"},{"location":"api/latest/calrissian/executor/#methods_1","title":"Methods","text":""},{"location":"api/latest/calrissian/executor/#with_traceback_1","title":"with_traceback","text":"<pre><code>def with_traceback(\n    ...\n)\n</code></pre> <p>Exception.with_traceback(tb) --</p> <p>set self.traceback to tb and return self.</p>"},{"location":"api/latest/calrissian/executor/#inconsistentresourcesexception","title":"InconsistentResourcesException","text":"<pre><code>class InconsistentResourcesException(\n    /,\n    *args,\n    **kwargs\n)\n</code></pre> <p>Common base class for all non-exit exceptions.</p>"},{"location":"api/latest/calrissian/executor/#ancestors-in-mro_2","title":"Ancestors (in MRO)","text":"<ul> <li>builtins.Exception</li> <li>builtins.BaseException</li> </ul>"},{"location":"api/latest/calrissian/executor/#class-variables_2","title":"Class variables","text":"<pre><code>args\n</code></pre>"},{"location":"api/latest/calrissian/executor/#methods_2","title":"Methods","text":""},{"location":"api/latest/calrissian/executor/#with_traceback_2","title":"with_traceback","text":"<pre><code>def with_traceback(\n    ...\n)\n</code></pre> <p>Exception.with_traceback(tb) --</p> <p>set self.traceback to tb and return self.</p>"},{"location":"api/latest/calrissian/executor/#jobresourcequeue","title":"JobResourceQueue","text":"<pre><code>class JobResourceQueue(\n    priority='ram',\n    descending=False\n)\n</code></pre> <p>Contains a dictionary of jobs, mapped to their resources.</p> <p>Provides an interface for getting a subset of jobs that fit within a resource limit</p>"},{"location":"api/latest/calrissian/executor/#methods_3","title":"Methods","text":""},{"location":"api/latest/calrissian/executor/#dequeue","title":"dequeue","text":"<pre><code>def dequeue(\n    self,\n    resource_limit\n)\n</code></pre> <p>Collects jobs from the sorted list that fit together within the specified resource limit.</p> <p>Removes (pop) collected jobs from the queue (pop). May return an empty dictionary if queue is empty or no jobs fit.imit</p> <p>Parameters:</p> Name Type Description Default resource_limit None A Resource object None <p>Returns:</p> Type Description None Dictionary of"},{"location":"api/latest/calrissian/executor/#enqueue","title":"enqueue","text":"<pre><code>def enqueue(\n    self,\n    job\n)\n</code></pre> <p>Add a job to the queue. Raises if job already exists in the queue</p> <p>Parameters:</p> Name Type Description Default job None A job to add to the queue None"},{"location":"api/latest/calrissian/executor/#is_empty","title":"is_empty","text":"<pre><code>def is_empty(\n    self\n)\n</code></pre> <p>Is the queue empty</p> <p>Returns:</p> Type Description None True if the queue is empty, False otherwise"},{"location":"api/latest/calrissian/executor/#sorted_jobs","title":"sorted_jobs","text":"<pre><code>def sorted_jobs(\n    self\n)\n</code></pre> <p>Produces a list of the jobs in the queue, ordered by self.priority (RAM or CORES) and ascending or descending</p> <p>Returns:</p> Type Description None"},{"location":"api/latest/calrissian/executor/#oversizedjobexception","title":"OversizedJobException","text":"<pre><code>class OversizedJobException(\n    /,\n    *args,\n    **kwargs\n)\n</code></pre> <p>Common base class for all non-exit exceptions.</p>"},{"location":"api/latest/calrissian/executor/#ancestors-in-mro_3","title":"Ancestors (in MRO)","text":"<ul> <li>builtins.Exception</li> <li>builtins.BaseException</li> </ul>"},{"location":"api/latest/calrissian/executor/#class-variables_3","title":"Class variables","text":"<pre><code>args\n</code></pre>"},{"location":"api/latest/calrissian/executor/#methods_4","title":"Methods","text":""},{"location":"api/latest/calrissian/executor/#with_traceback_3","title":"with_traceback","text":"<pre><code>def with_traceback(\n    ...\n)\n</code></pre> <p>Exception.with_traceback(tb) --</p> <p>set self.traceback to tb and return self.</p>"},{"location":"api/latest/calrissian/executor/#resources","title":"Resources","text":"<pre><code>class Resources(\n    ram=0,\n    cores=0,\n    gpus=0\n)\n</code></pre> <p>Class to encapsulate compute resources and provide arithmetic operations and comparisons</p>"},{"location":"api/latest/calrissian/executor/#class-variables_4","title":"Class variables","text":"<pre><code>CORES\n</code></pre> <pre><code>EMPTY\n</code></pre> <pre><code>GPUS\n</code></pre> <pre><code>RAM\n</code></pre>"},{"location":"api/latest/calrissian/executor/#static-methods","title":"Static methods","text":""},{"location":"api/latest/calrissian/executor/#from_dict","title":"from_dict","text":"<pre><code>def from_dict(\n    d\n)\n</code></pre>"},{"location":"api/latest/calrissian/executor/#from_job","title":"from_job","text":"<pre><code>def from_job(\n    job\n)\n</code></pre>"},{"location":"api/latest/calrissian/executor/#min","title":"min","text":"<pre><code>def min(\n    rsc1,\n    rsc2\n)\n</code></pre>"},{"location":"api/latest/calrissian/executor/#methods_5","title":"Methods","text":""},{"location":"api/latest/calrissian/executor/#exceeds","title":"exceeds","text":"<pre><code>def exceeds(\n    self,\n    other\n)\n</code></pre>"},{"location":"api/latest/calrissian/executor/#is_negative","title":"is_negative","text":"<pre><code>def is_negative(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/executor/#to_dict","title":"to_dict","text":"<pre><code>def to_dict(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/executor/#threadpooljobexecutor","title":"ThreadPoolJobExecutor","text":"<pre><code>class ThreadPoolJobExecutor(\n    total_ram,\n    total_cores,\n    total_gpus=0,\n    max_workers=None\n)\n</code></pre> <p>A cwltool JobExecutor subclass that uses concurrent.futures.ThreadPoolExecutor</p> <p>concurrent.futures was introduced in Python 3.2 and provides high-level interfaces (Executor, Future) for launching and managing asynchronous and parallel tasks. The ThreadPoolExecutor maintains a pool of reusable threads to execute tasks, reducing the overall number of threads that are created in the cwltool process.</p> <p>Relevant: https://github.com/common-workflow-language/cwltool/issues/888</p>"},{"location":"api/latest/calrissian/executor/#ancestors-in-mro_4","title":"Ancestors (in MRO)","text":"<ul> <li>cwltool.executors.JobExecutor</li> </ul>"},{"location":"api/latest/calrissian/executor/#methods_6","title":"Methods","text":""},{"location":"api/latest/calrissian/executor/#allocate","title":"allocate","text":"<pre><code>def allocate(\n    self,\n    rsc,\n    logger\n)\n</code></pre> <p>Reserve resources from the total. Raises InconsistentResourcesException if available becomes negative</p> <p>Parameters:</p> Name Type Description Default rsc None A Resources object to reserve from the total. None logger None logger where messages shall be logged None"},{"location":"api/latest/calrissian/executor/#drain_queue","title":"drain_queue","text":"<pre><code>def drain_queue(\n    self,\n    logger,\n    runtime_context,\n    pool_executor,\n    futures\n)\n</code></pre> <p>Start queued jobs and wait for all futures to complete</p> <p>Parameters:</p> Name Type Description Default logger None logger where messages shall be logged None runtime_context None cwltool RuntimeContext: to provide to the job None pool_executor None concurrent.futures.Executor on which to run job functions None futures None set of Futures for jobs already started None <p>Returns:</p> Type Description None None"},{"location":"api/latest/calrissian/executor/#enqueue_jobs_from_iterator","title":"enqueue_jobs_from_iterator","text":"<pre><code>def enqueue_jobs_from_iterator(\n    self,\n    job_iterator,\n    logger,\n    runtime_context,\n    pool_executor\n)\n</code></pre> <p>Phase 1: Iterate over jobs, and queue them for execution. When the iterator returns None, that indicates</p> <p>progress is blocked until earlier jobs complete. At that point, this method starts jobs from the queue, submitting each as a Future to the pool_executor. Returns the set of submitted futures for phase 2 to watch.</p> <p>Parameters:</p> Name Type Description Default job_iterator None iterator that yields cwltool Jobs None logger None logger where messages shall be logged None runtime_context None cwltool RuntimeContext: to provide to the job None pool_executor None A concurrent.futures.Executor on which to run job functions None <p>Returns:</p> Type Description None set of Futures for jobs that have been submitted off the queue"},{"location":"api/latest/calrissian/executor/#execute","title":"execute","text":"<pre><code>def execute(\n    self,\n    process: cwltool.process.Process,\n    job_order_object: collections.abc.MutableMapping[str, typing.Union[NoneType, bool, str, int, float, collections.abc.MutableSequence['CWLOutputType'], collections.abc.MutableMapping[str, 'CWLOutputType']]],\n    runtime_context: cwltool.context.RuntimeContext,\n    logger: logging.Logger = &lt;Logger cwltool (INFO)&gt;\n) -&gt; tuple[collections.abc.MutableMapping[str, typing.Union[NoneType, bool, str, int, float, collections.abc.MutableSequence['CWLOutputType'], collections.abc.MutableMapping[str, 'CWLOutputType']]] | None, str]\n</code></pre> <p>Execute the process.</p>"},{"location":"api/latest/calrissian/executor/#job_done_callback","title":"job_done_callback","text":"<pre><code>def job_done_callback(\n    self,\n    rsc,\n    logger,\n    future\n)\n</code></pre> <p>Callback to run after a job is finished to restore reserved resources and check for exceptions.</p> <p>Expected to be called as part of the Future.add_done_callback(). The callback is invoked on a background thread. If the callback itself raises an Exception, that Exception is logged and ignored, so we instead queue exceptions and re-raise from the main thread.</p> <p>Parameters:</p> Name Type Description Default rsc None Resources used by the job to return to our available resources. None logger None logger where messages shall be logged None future None A concurrent.futures.Future representing the finished task. May be in cancelled or done states None"},{"location":"api/latest/calrissian/executor/#output_callback","title":"output_callback","text":"<pre><code>def output_callback(\n    self,\n    out: collections.abc.MutableMapping[str, typing.Union[NoneType, bool, str, int, float, collections.abc.MutableSequence['CWLOutputType'], collections.abc.MutableMapping[str, 'CWLOutputType']]] | None,\n    process_status: str\n) -&gt; None\n</code></pre> <p>Collect the final status and outputs.</p>"},{"location":"api/latest/calrissian/executor/#raise_if_exception_queued","title":"raise_if_exception_queued","text":"<pre><code>def raise_if_exception_queued(\n    self,\n    futures,\n    logger\n)\n</code></pre> <p>Method to run on the main thread that will raise a queued exception added by job_done_callback and</p> <p>cancel any outstanding futures</p> <p>Parameters:</p> Name Type Description Default futures None set of any futures that should be cancelled if we're about to raise an exception None logger None logger where messages shall be logged None"},{"location":"api/latest/calrissian/executor/#raise_if_oversized","title":"raise_if_oversized","text":"<pre><code>def raise_if_oversized(\n    self,\n    job\n)\n</code></pre> <p>Raise an exception if a job does not fit within total_resources</p> <p>Parameters:</p> Name Type Description Default job None Job to check resources None"},{"location":"api/latest/calrissian/executor/#restore","title":"restore","text":"<pre><code>def restore(\n    self,\n    rsc,\n    logger\n)\n</code></pre> <p>Restore resources to the total. Raises InconsistentResourcesException if available becomes negative</p> <p>Parameters:</p> Name Type Description Default rsc None A Resources object to restore to the total None logger None logger where messages shall be logged None"},{"location":"api/latest/calrissian/executor/#run_jobs","title":"run_jobs","text":"<pre><code>def run_jobs(\n    self,\n    process,\n    job_order_object,\n    logger,\n    runtime_context\n)\n</code></pre> <p>Concrete implementation of JobExecutor.run_jobs, the primary entry point for this class.</p> <p>Parameters:</p> Name Type Description Default process None cwltool.process.Process: The process object on which to call .job() yielding jobs None job_order_object None dict: The CWL job order None logger None logger where messages shall be logged None runtime_context None cwltool RuntimeContext: to provide to the job None <p>Returns:</p> Type Description None None"},{"location":"api/latest/calrissian/executor/#select_resources","title":"select_resources","text":"<pre><code>def select_resources(\n    self,\n    request,\n    runtime_context\n)\n</code></pre> <p>Na\u00efve check for available cores cores and memory</p> <p>Checks if requested resources fit within the total allocation, raises WorkflowException if not. If fits, returns a dictionary of resources that satisfy the requested min/max</p> <p>Parameters:</p> Name Type Description Default request None dict of ramMin, coresMin, ramMax, coresMax None runtime_context None RuntimeContext, unused None <p>Returns:</p> Type Description None dict of selected resources"},{"location":"api/latest/calrissian/executor/#start_queued_jobs","title":"start_queued_jobs","text":"<pre><code>def start_queued_jobs(\n    self,\n    pool_executor,\n    logger,\n    runtime_context\n)\n</code></pre> <p>Pulls jobs off the queue in groups that fit in currently available resources, allocates resources, and submits</p> <p>jobs to the pool_executor as Futures. Attaches a callback to each future to clean up (e.g. check for execptions, restore allocated resources)</p> <p>Parameters:</p> Name Type Description Default pool_executor None concurrent.futures.Executor: where job callables shall be submitted None logger None logger where messages shall be logged None runtime_context None cwltool RuntimeContext: to provide to the job None <p>Returns:</p> Type Description None set: futures that were submitted on this invocation"},{"location":"api/latest/calrissian/executor/#wait_for_completion","title":"wait_for_completion","text":"<pre><code>def wait_for_completion(\n    self,\n    futures,\n    logger\n)\n</code></pre> <p>Using concurrent.futures.wait, wait for one of the futures in the set to complete, remove finished futures from</p> <p>the set, and check if any exceptions occurred.</p> <p>Parameters:</p> Name Type Description Default futures None set: A set of futures on which to wait None logger None logger where messages shall be logged None <p>Returns:</p> Type Description None The set of futures that is not yet done"},{"location":"api/latest/calrissian/job/","title":"Module calrissian.job","text":""},{"location":"api/latest/calrissian/job/#variables","title":"Variables","text":"<pre><code>DEFAULT_INIT_IMAGE\n</code></pre> <pre><code>DEFAULT_TMP_PREFIX\n</code></pre> <pre><code>INIT_IMAGE_ENV_VARIABLE\n</code></pre> <pre><code>K8S_UNSAFE_REGEX\n</code></pre> <pre><code>log\n</code></pre> <pre><code>log_main\n</code></pre>"},{"location":"api/latest/calrissian/job/#functions","title":"Functions","text":""},{"location":"api/latest/calrissian/job/#k8s_safe_name","title":"k8s_safe_name","text":"<pre><code>def k8s_safe_name(\n    name\n)\n</code></pre> <p>Kubernetes does not allow underscores, and in some names/labels no '.'</p> <p>DNS-1123 label must consist of lower case alphanumeric characters or '-', and must start and end with an alphanumeric character regex used for validation is 'a-z0-9?'</p> <p>Parameters:</p> Name Type Description Default name None None <p>Returns:</p> Type Description None a safe name"},{"location":"api/latest/calrissian/job/#quoted_arg_list","title":"quoted_arg_list","text":"<pre><code>def quoted_arg_list(\n    arg_list\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#random_tag","title":"random_tag","text":"<pre><code>def random_tag(\n    length=8\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#read_yaml","title":"read_yaml","text":"<pre><code>def read_yaml(\n    filename\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#total_size","title":"total_size","text":"<pre><code>def total_size(\n    outputs\n)\n</code></pre> <p>Recursively walk through an output dictionary object, totaling</p> <p>up file size from each dictionary where 'class' == 'File'</p> <p>Parameters:</p> Name Type Description Default outputs None output dictionary from a CWL job None <p>Returns:</p> Type Description None Sum of all 'size' field values found"},{"location":"api/latest/calrissian/job/#classes","title":"Classes","text":""},{"location":"api/latest/calrissian/job/#calrissiancommandlinejob","title":"CalrissianCommandLineJob","text":"<pre><code>class CalrissianCommandLineJob(\n    *args,\n    **kwargs\n)\n</code></pre> <p>Commandline job using containers.</p>"},{"location":"api/latest/calrissian/job/#ancestors-in-mro","title":"Ancestors (in MRO)","text":"<ul> <li>cwltool.job.ContainerCommandLineJob</li> <li>cwltool.job.JobBase</li> <li>cwltool.utils.HasReqsHints</li> </ul>"},{"location":"api/latest/calrissian/job/#descendants","title":"Descendants","text":"<ul> <li>calrissian.dask.CalrissianCommandLineDaskJob</li> </ul>"},{"location":"api/latest/calrissian/job/#class-variables","title":"Class variables","text":"<pre><code>CONTAINER_TMPDIR\n</code></pre> <pre><code>container_tmpdir\n</code></pre> <pre><code>supported_features\n</code></pre>"},{"location":"api/latest/calrissian/job/#static-methods","title":"Static methods","text":""},{"location":"api/latest/calrissian/job/#extract_environment","title":"extract_environment","text":"<pre><code>def extract_environment(\n    runtimeContext: cwltool.context.RuntimeContext,\n    envVarReq: collections.abc.Mapping[str, str]\n) -&gt; collections.abc.Mapping[str, str]\n</code></pre> <p>Extract environment variables that should be preserved.</p>"},{"location":"api/latest/calrissian/job/#methods","title":"Methods","text":""},{"location":"api/latest/calrissian/job/#add_file_or_directory_volume","title":"add_file_or_directory_volume","text":"<pre><code>def add_file_or_directory_volume(\n    self,\n    runtime,\n    volume,\n    host_outdir_tgt\n)\n</code></pre> <p>Append volume a file/dir mapping to the runtime option list.</p>"},{"location":"api/latest/calrissian/job/#add_volumes","title":"add_volumes","text":"<pre><code>def add_volumes(\n    self,\n    pathmapper: cwltool.pathmapper.PathMapper,\n    runtime: list[str],\n    tmpdir_prefix: str,\n    secret_store: cwltool.secrets.SecretStore | None = None,\n    any_path_okay: bool = False\n) -&gt; None\n</code></pre> <p>Append volume mappings to the runtime option list.</p>"},{"location":"api/latest/calrissian/job/#add_writable_directory_volume","title":"add_writable_directory_volume","text":"<pre><code>def add_writable_directory_volume(\n    self,\n    runtime,\n    volume,\n    host_outdir_tgt,\n    tmpdir_prefix\n)\n</code></pre> <p>Append a writable directory mapping to the runtime option list.</p>"},{"location":"api/latest/calrissian/job/#add_writable_file_volume","title":"add_writable_file_volume","text":"<pre><code>def add_writable_file_volume(\n    self,\n    runtime,\n    volume,\n    host_outdir_tgt,\n    tmpdir_prefix\n)\n</code></pre> <p>Append a writable file mapping to the runtime option list.</p>"},{"location":"api/latest/calrissian/job/#append_volume","title":"append_volume","text":"<pre><code>def append_volume(\n    self,\n    runtime,\n    source,\n    target,\n    writable=False\n)\n</code></pre> <p>Add volume binding to the arguments list.</p> <p>This is called by the base class for file literals after they've been created. We already have a similar function, so we just call that.</p>"},{"location":"api/latest/calrissian/job/#check_requirements","title":"check_requirements","text":"<pre><code>def check_requirements(\n    self,\n    runtimeContext\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#create_file_and_add_volume","title":"create_file_and_add_volume","text":"<pre><code>def create_file_and_add_volume(\n    self,\n    runtime: list[str],\n    volume: cwltool.pathmapper.MapperEnt,\n    host_outdir_tgt: str | None,\n    secret_store: cwltool.secrets.SecretStore | None,\n    tmpdir_prefix: str\n) -&gt; str\n</code></pre> <p>Create the file and add a mapping.</p>"},{"location":"api/latest/calrissian/job/#create_kubernetes_runtime","title":"create_kubernetes_runtime","text":"<pre><code>def create_kubernetes_runtime(\n    self,\n    runtimeContext\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#create_runtime","title":"create_runtime","text":"<pre><code>def create_runtime(\n    self,\n    env,\n    runtime_context\n)\n</code></pre> <p>Return the list of commands to run the selected container engine.</p>"},{"location":"api/latest/calrissian/job/#docker_monitor","title":"docker_monitor","text":"<pre><code>def docker_monitor(\n    self,\n    cidfile: str,\n    tmpdir_prefix: str,\n    cleanup_cidfile: bool,\n    docker_exe: str,\n    process: 'subprocess.Popen[str]'\n) -&gt; None\n</code></pre> <p>Record memory usage of the running Docker container.</p>"},{"location":"api/latest/calrissian/job/#dump_tool_logs","title":"dump_tool_logs","text":"<pre><code>def dump_tool_logs(\n    self,\n    name,\n    completion_result: calrissian.k8s.CompletionResult,\n    runtime_context\n)\n</code></pre> <p>Dumps the tool logs</p>"},{"location":"api/latest/calrissian/job/#execute_kubernetes_pod","title":"execute_kubernetes_pod","text":"<pre><code>def execute_kubernetes_pod(\n    self,\n    pod\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#finish","title":"finish","text":"<pre><code>def finish(\n    self,\n    completion_result: calrissian.k8s.CompletionResult,\n    runtimeContext\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#get_from_requirements","title":"get_from_requirements","text":"<pre><code>def get_from_requirements(\n    self,\n    r,\n    pull_image,\n    force_pull=False,\n    tmp_outdir_prefix='/tmp/'\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#get_network_access_pod_labels","title":"get_network_access_pod_labels","text":"<pre><code>def get_network_access_pod_labels(\n    self,\n    runtimeContext\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#get_no_network_access_pod_labels","title":"get_no_network_access_pod_labels","text":"<pre><code>def get_no_network_access_pod_labels(\n    self,\n    runtimeContext\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#get_pod_additional_spec","title":"get_pod_additional_spec","text":"<pre><code>def get_pod_additional_spec(\n    self,\n    runtimeContext\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#get_pod_env_from_configmap","title":"get_pod_env_from_configmap","text":"<pre><code>def get_pod_env_from_configmap(\n    self,\n    runtimeContext\n) -&gt; list\n</code></pre>"},{"location":"api/latest/calrissian/job/#get_pod_env_from_secret","title":"get_pod_env_from_secret","text":"<pre><code>def get_pod_env_from_secret(\n    self,\n    runtimeContext\n) -&gt; list\n</code></pre>"},{"location":"api/latest/calrissian/job/#get_pod_env_vars","title":"get_pod_env_vars","text":"<pre><code>def get_pod_env_vars(\n    self,\n    runtimeContext\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#get_pod_gpu_nodeselectors","title":"get_pod_gpu_nodeselectors","text":"<pre><code>def get_pod_gpu_nodeselectors(\n    self,\n    runtimeContext\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#get_pod_labels","title":"get_pod_labels","text":"<pre><code>def get_pod_labels(\n    self,\n    runtimeContext\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#get_pod_nodeselectors","title":"get_pod_nodeselectors","text":"<pre><code>def get_pod_nodeselectors(\n    self,\n    runtimeContext\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#get_pod_priority_class","title":"get_pod_priority_class","text":"<pre><code>def get_pod_priority_class(\n    self,\n    runtimeContext\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#get_pod_serviceaccount","title":"get_pod_serviceaccount","text":"<pre><code>def get_pod_serviceaccount(\n    self,\n    runtimeContext\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#get_requirement","title":"get_requirement","text":"<pre><code>def get_requirement(\n    self,\n    feature: str\n) -&gt; tuple[collections.abc.MutableMapping[str, typing.Union[NoneType, bool, str, int, float, collections.abc.MutableSequence['CWLOutputType'], collections.abc.MutableMapping[str, 'CWLOutputType']]] | None, bool | None]\n</code></pre> <p>Retrieve the named feature from the requirements field, or the hints field.</p>"},{"location":"api/latest/calrissian/job/#get_security_context","title":"get_security_context","text":"<pre><code>def get_security_context(\n    self,\n    runtimeContext\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#make_tmpdir","title":"make_tmpdir","text":"<pre><code>def make_tmpdir(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#populate_env_vars","title":"populate_env_vars","text":"<pre><code>def populate_env_vars(\n    self,\n    runtimeContext\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#prepare_environment","title":"prepare_environment","text":"<pre><code>def prepare_environment(\n    self,\n    runtimeContext: cwltool.context.RuntimeContext,\n    envVarReq: collections.abc.Mapping[str, str]\n) -&gt; None\n</code></pre> <p>Set up environment variables.</p> <p>Here we prepare the environment for the job, based on any preserved variables and <code>EnvVarRequirement</code>. Later, changes due to <code>MPIRequirement</code>, <code>Secrets</code>, or <code>SoftwareRequirement</code> are applied (in that order).</p>"},{"location":"api/latest/calrissian/job/#process_monitor","title":"process_monitor","text":"<pre><code>def process_monitor(\n    self,\n    sproc: 'subprocess.Popen[str]'\n) -&gt; None\n</code></pre> <p>Watch a process, logging its max memory usage.</p>"},{"location":"api/latest/calrissian/job/#quoted_command_line","title":"quoted_command_line","text":"<pre><code>def quoted_command_line(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#report","title":"report","text":"<pre><code>def report(\n    self,\n    completion_result: calrissian.k8s.CompletionResult,\n    disk_bytes\n)\n</code></pre> <p>Convert the k8s-specific completion result into a report and submit it</p> <p>Parameters:</p> Name Type Description Default completion_result None calrissian.k8s.CompletionResult None"},{"location":"api/latest/calrissian/job/#run","title":"run","text":"<pre><code>def run(\n    self,\n    runtimeContext,\n    tmpdir_lock=None\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#setup_kubernetes","title":"setup_kubernetes","text":"<pre><code>def setup_kubernetes(\n    self,\n    runtime_context\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#wait_for_kubernetes_pod","title":"wait_for_kubernetes_pod","text":"<pre><code>def wait_for_kubernetes_pod(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#calrissiancommandlinejobexception","title":"CalrissianCommandLineJobException","text":"<pre><code>class CalrissianCommandLineJobException(\n    /,\n    *args,\n    **kwargs\n)\n</code></pre> <p>Common base class for all non-exit exceptions.</p>"},{"location":"api/latest/calrissian/job/#ancestors-in-mro_1","title":"Ancestors (in MRO)","text":"<ul> <li>cwl_utils.errors.WorkflowException</li> <li>builtins.Exception</li> <li>builtins.BaseException</li> </ul>"},{"location":"api/latest/calrissian/job/#class-variables_1","title":"Class variables","text":"<pre><code>args\n</code></pre>"},{"location":"api/latest/calrissian/job/#methods_1","title":"Methods","text":""},{"location":"api/latest/calrissian/job/#with_traceback","title":"with_traceback","text":"<pre><code>def with_traceback(\n    ...\n)\n</code></pre> <p>Exception.with_traceback(tb) --</p> <p>set self.traceback to tb and return self.</p>"},{"location":"api/latest/calrissian/job/#kubernetespodbuilder","title":"KubernetesPodBuilder","text":"<pre><code>class KubernetesPodBuilder(\n    name,\n    builder,\n    container_image,\n    environment,\n    volume_mounts,\n    volumes,\n    command_line,\n    stdout,\n    stderr,\n    stdin,\n    labels,\n    nodeselectors,\n    gpu_nodeselectors,\n    security_context,\n    serviceaccount,\n    pod_additional_spec=None,\n    no_network_access_pod_labels=None,\n    network_access_pod_labels=None\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#descendants_1","title":"Descendants","text":"<ul> <li>calrissian.dask.KubernetesDaskPodBuilder</li> </ul>"},{"location":"api/latest/calrissian/job/#static-methods_1","title":"Static methods","text":""},{"location":"api/latest/calrissian/job/#resource_type","title":"resource_type","text":"<pre><code>def resource_type(\n    cwl_field\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#resource_value","title":"resource_value","text":"<pre><code>def resource_value(\n    kind,\n    cwl_value\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#methods_2","title":"Methods","text":""},{"location":"api/latest/calrissian/job/#build","title":"build","text":"<pre><code>def build(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#container_args","title":"container_args","text":"<pre><code>def container_args(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#container_command","title":"container_command","text":"<pre><code>def container_command(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#container_environment","title":"container_environment","text":"<pre><code>def container_environment(\n    self\n)\n</code></pre> <p>Build the environment line for the kubernetes yaml</p> <p>Returns:</p> Type Description None array of env variables to set"},{"location":"api/latest/calrissian/job/#container_name","title":"container_name","text":"<pre><code>def container_name(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#container_resources","title":"container_resources","text":"<pre><code>def container_resources(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#container_workingdir","title":"container_workingdir","text":"<pre><code>def container_workingdir(\n    self\n)\n</code></pre> <p>Return the working directory for this container</p> <p>Returns:</p> Type Description None"},{"location":"api/latest/calrissian/job/#init_container_name","title":"init_container_name","text":"<pre><code>def init_container_name(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#init_containers","title":"init_containers","text":"<pre><code>def init_containers(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#pod_envfromconfigmap","title":"pod_envfromconfigmap","text":"<pre><code>def pod_envfromconfigmap(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#pod_envfromsecret","title":"pod_envfromsecret","text":"<pre><code>def pod_envfromsecret(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#pod_labels","title":"pod_labels","text":"<pre><code>def pod_labels(\n    self\n)\n</code></pre> <p>Submitted labels must be strings</p> <p>Returns:</p> Type Description None"},{"location":"api/latest/calrissian/job/#pod_name","title":"pod_name","text":"<pre><code>def pod_name(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#select_pod_nodeselectors","title":"select_pod_nodeselectors","text":"<pre><code>def select_pod_nodeselectors(\n    self\n)\n</code></pre> <p>Return the appropriate Kubernetes node selectors for the pod.</p> <p>If the job requirements include a CUDA requirement (either 'cwltool:CUDARequirement' or 'http://commonwl.org/cwltool#CUDARequirement'), GPU-specific node selectors are used. Otherwise, the default node selectors are returned.</p> <p>Returns:</p> Type Description None A dict of node selector labels (str -&gt; str)"},{"location":"api/latest/calrissian/job/#kubernetespodvolumeinspector","title":"KubernetesPodVolumeInspector","text":"<pre><code>class KubernetesPodVolumeInspector(\n    pod\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#methods_3","title":"Methods","text":""},{"location":"api/latest/calrissian/job/#get_first_container","title":"get_first_container","text":"<pre><code>def get_first_container(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#get_mounted_persistent_volumes","title":"get_mounted_persistent_volumes","text":"<pre><code>def get_mounted_persistent_volumes(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#get_persistent_volumes_dict","title":"get_persistent_volumes_dict","text":"<pre><code>def get_persistent_volumes_dict(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#kubernetesvolumebuilder","title":"KubernetesVolumeBuilder","text":"<pre><code>class KubernetesVolumeBuilder(\n\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#static-methods_2","title":"Static methods","text":""},{"location":"api/latest/calrissian/job/#calculate_subpath","title":"calculate_subpath","text":"<pre><code>def calculate_subpath(\n    source,\n    prefix,\n    parent_sub_path\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#methods_4","title":"Methods","text":""},{"location":"api/latest/calrissian/job/#add_configmap_volume","title":"add_configmap_volume","text":"<pre><code>def add_configmap_volume(\n    self,\n    name,\n    cm_name\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#add_configmap_volume_binding","title":"add_configmap_volume_binding","text":"<pre><code>def add_configmap_volume_binding(\n    self,\n    name,\n    target\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#add_emptydir_volume","title":"add_emptydir_volume","text":"<pre><code>def add_emptydir_volume(\n    self,\n    name\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#add_emptydir_volume_binding","title":"add_emptydir_volume_binding","text":"<pre><code>def add_emptydir_volume_binding(\n    self,\n    name,\n    target\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#add_persistent_volume_entries_from_pod","title":"add_persistent_volume_entries_from_pod","text":"<pre><code>def add_persistent_volume_entries_from_pod(\n    self,\n    pod\n)\n</code></pre> <p>Add a mounted persistent volume claim for each mounted PVC in the specified pod</p> <p>Parameters:</p> Name Type Description Default pod None V1Pod None"},{"location":"api/latest/calrissian/job/#add_persistent_volume_entry","title":"add_persistent_volume_entry","text":"<pre><code>def add_persistent_volume_entry(\n    self,\n    prefix,\n    sub_path,\n    claim_name,\n    read_only\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#add_volume_binding","title":"add_volume_binding","text":"<pre><code>def add_volume_binding(\n    self,\n    source,\n    target,\n    writable\n)\n</code></pre>"},{"location":"api/latest/calrissian/job/#find_persistent_volume","title":"find_persistent_volume","text":"<pre><code>def find_persistent_volume(\n    self,\n    source\n)\n</code></pre> <p>For a given source path, return the volume entry that contains it</p>"},{"location":"api/latest/calrissian/job/#volumebuilderexception","title":"VolumeBuilderException","text":"<pre><code>class VolumeBuilderException(\n    /,\n    *args,\n    **kwargs\n)\n</code></pre> <p>Common base class for all non-exit exceptions.</p>"},{"location":"api/latest/calrissian/job/#ancestors-in-mro_2","title":"Ancestors (in MRO)","text":"<ul> <li>cwl_utils.errors.WorkflowException</li> <li>builtins.Exception</li> <li>builtins.BaseException</li> </ul>"},{"location":"api/latest/calrissian/job/#class-variables_2","title":"Class variables","text":"<pre><code>args\n</code></pre>"},{"location":"api/latest/calrissian/job/#methods_5","title":"Methods","text":""},{"location":"api/latest/calrissian/job/#with_traceback_1","title":"with_traceback","text":"<pre><code>def with_traceback(\n    ...\n)\n</code></pre> <p>Exception.with_traceback(tb) --</p> <p>set self.traceback to tb and return self.</p>"},{"location":"api/latest/calrissian/k8s/","title":"Module calrissian.k8s","text":""},{"location":"api/latest/calrissian/k8s/#variables","title":"Variables","text":"<pre><code>K8S_FALLBACK_NAMESPACE\n</code></pre> <pre><code>K8S_NAMESPACE_FILE\n</code></pre> <pre><code>POD_NAME_ENV_VARIABLE\n</code></pre> <pre><code>log\n</code></pre>"},{"location":"api/latest/calrissian/k8s/#functions","title":"Functions","text":""},{"location":"api/latest/calrissian/k8s/#load_config_get_namespace","title":"load_config_get_namespace","text":"<pre><code>def load_config_get_namespace(\n\n)\n</code></pre>"},{"location":"api/latest/calrissian/k8s/#read_file","title":"read_file","text":"<pre><code>def read_file(\n    path\n)\n</code></pre>"},{"location":"api/latest/calrissian/k8s/#classes","title":"Classes","text":""},{"location":"api/latest/calrissian/k8s/#calrissianjobexception","title":"CalrissianJobException","text":"<pre><code>class CalrissianJobException(\n    /,\n    *args,\n    **kwargs\n)\n</code></pre> <p>Common base class for all non-exit exceptions.</p>"},{"location":"api/latest/calrissian/k8s/#ancestors-in-mro","title":"Ancestors (in MRO)","text":"<ul> <li>builtins.Exception</li> <li>builtins.BaseException</li> </ul>"},{"location":"api/latest/calrissian/k8s/#class-variables","title":"Class variables","text":"<pre><code>args\n</code></pre>"},{"location":"api/latest/calrissian/k8s/#methods","title":"Methods","text":""},{"location":"api/latest/calrissian/k8s/#with_traceback","title":"with_traceback","text":"<pre><code>def with_traceback(\n    ...\n)\n</code></pre> <p>Exception.with_traceback(tb) --</p> <p>set self.traceback to tb and return self.</p>"},{"location":"api/latest/calrissian/k8s/#completionresult","title":"CompletionResult","text":"<pre><code>class CompletionResult(\n    exit_code,\n    cpus,\n    memory,\n    start_time,\n    finish_time,\n    tool_log,\n    node_selectors\n)\n</code></pre> <p>Simple structure to hold information about pod execution duration and resources.</p> <p>The CPU and memory values should be in kubernetes units (strings).</p>"},{"location":"api/latest/calrissian/k8s/#kubernetesclient","title":"KubernetesClient","text":"<pre><code>class KubernetesClient(\n\n)\n</code></pre> <p>Instances of this class are created by a <code>calrissian.job.CalrissianCommandLineJob</code>,</p> <p>which are often running in background threads (spawned by <code>calrissian.executor.MultithreadedJobExecutor</code></p> <p>This class uses a PodMonitor to keep track of the pods it submits in a single, shared list. KubernetesClient is responsible for telling PodMonitor after it has submitted a pod and when it knows that pod is terminated. Using PodMonitor as a context manager (with PodMonitor() as p) acquires a lock for thread safety.</p>"},{"location":"api/latest/calrissian/k8s/#descendants","title":"Descendants","text":"<ul> <li>calrissian.dask.KubernetesDaskClient</li> </ul>"},{"location":"api/latest/calrissian/k8s/#static-methods","title":"Static methods","text":""},{"location":"api/latest/calrissian/k8s/#format_log_entry","title":"format_log_entry","text":"<pre><code>def format_log_entry(\n    pod_name,\n    log_entry\n)\n</code></pre>"},{"location":"api/latest/calrissian/k8s/#get_first_or_none","title":"get_first_or_none","text":"<pre><code>def get_first_or_none(\n    container_list: List[Union[kubernetes.client.models.v1_container_status.V1ContainerStatus, kubernetes.client.models.v1_container.V1Container]]\n) -&gt; Union[kubernetes.client.models.v1_container_status.V1ContainerStatus, kubernetes.client.models.v1_container.V1Container]\n</code></pre> <p>Check the list. Should be 0 or 1 items. If 0, there's no container yet. If 1, there's a</p> <p>container. If &gt; 1, there's more than 1 container and that's unexpected behavior</p> <p>Parameters:</p> Name Type Description Default containers_or_container_statuses None list of V1ContainerStatus or V1Container None <p>Returns:</p> Type Description None first item if len of list is 1, None if 0, and raises CalrissianJobException if &gt; 1"},{"location":"api/latest/calrissian/k8s/#state_is_running","title":"state_is_running","text":"<pre><code>def state_is_running(\n    state\n)\n</code></pre>"},{"location":"api/latest/calrissian/k8s/#state_is_terminated","title":"state_is_terminated","text":"<pre><code>def state_is_terminated(\n    state\n)\n</code></pre>"},{"location":"api/latest/calrissian/k8s/#state_is_waiting","title":"state_is_waiting","text":"<pre><code>def state_is_waiting(\n    state\n)\n</code></pre>"},{"location":"api/latest/calrissian/k8s/#methods_1","title":"Methods","text":""},{"location":"api/latest/calrissian/k8s/#delete_pod_name","title":"delete_pod_name","text":"<pre><code>def delete_pod_name(\n    self,\n    pod_name\n)\n</code></pre>"},{"location":"api/latest/calrissian/k8s/#follow_logs","title":"follow_logs","text":"<pre><code>def follow_logs(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/k8s/#get_current_pod","title":"get_current_pod","text":"<pre><code>def get_current_pod(\n    self\n)\n</code></pre> <p>Return pod details about the current pod (ie the one we are running inside of).</p> <p>Requires 'CALRISSIAN_POD_NAME' environment variable to be set.</p> <p>Returns:</p> Type Description None V1Pod"},{"location":"api/latest/calrissian/k8s/#get_pod_for_name","title":"get_pod_for_name","text":"<pre><code>def get_pod_for_name(\n    self,\n    pod_name\n)\n</code></pre> <p>Given a pod name return details about this pod</p> <p>Parameters:</p> Name Type Description Default pod_name None str: name of the pod to read data about None <p>Returns:</p> Type Description None V1Pod"},{"location":"api/latest/calrissian/k8s/#should_delete_pod","title":"should_delete_pod","text":"<pre><code>def should_delete_pod(\n    self\n)\n</code></pre> <p>Decide whether or not to delete a pod. Defaults to True if unset.</p> <p>Checks the CALRISSIAN_DELETE_PODS environment variable</p> <p>Returns:</p> Type Description None"},{"location":"api/latest/calrissian/k8s/#submit_pod","title":"submit_pod","text":"<pre><code>def submit_pod(\n    self,\n    pod_body\n)\n</code></pre>"},{"location":"api/latest/calrissian/k8s/#wait_for_completion","title":"wait_for_completion","text":"<pre><code>def wait_for_completion(\n    self\n) -&gt; calrissian.k8s.CompletionResult\n</code></pre>"},{"location":"api/latest/calrissian/k8s/#podmonitor","title":"PodMonitor","text":"<pre><code>class PodMonitor(\n    /,\n    *args,\n    **kwargs\n)\n</code></pre> <p>This class is designed to track pods submitted by KubernetesClient across different background threads,</p> <p>and provide a static cleanup() method to attempt to delete those pods on termination.</p> <p>Instances of this class are used as context manager, and acquire the shared lock. The add and remove methods should only be called from inside the context block while the lock is acquired.</p> <p>The static cleanup() method also acquires the lock and attempts to delete all outstanding pods.</p>"},{"location":"api/latest/calrissian/k8s/#descendants_1","title":"Descendants","text":"<ul> <li>calrissian.dask.DaskPodMonitor</li> </ul>"},{"location":"api/latest/calrissian/k8s/#class-variables_1","title":"Class variables","text":"<pre><code>lock\n</code></pre> <pre><code>pod_names\n</code></pre>"},{"location":"api/latest/calrissian/k8s/#static-methods_1","title":"Static methods","text":""},{"location":"api/latest/calrissian/k8s/#cleanup","title":"cleanup","text":"<pre><code>def cleanup(\n\n)\n</code></pre>"},{"location":"api/latest/calrissian/k8s/#methods_2","title":"Methods","text":""},{"location":"api/latest/calrissian/k8s/#add","title":"add","text":"<pre><code>def add(\n    self,\n    pod\n)\n</code></pre>"},{"location":"api/latest/calrissian/k8s/#remove","title":"remove","text":"<pre><code>def remove(\n    self,\n    pod\n)\n</code></pre>"},{"location":"api/latest/calrissian/main/","title":"Module calrissian.main","text":""},{"location":"api/latest/calrissian/main/#variables","title":"Variables","text":"<pre><code>log\n</code></pre>"},{"location":"api/latest/calrissian/main/#functions","title":"Functions","text":""},{"location":"api/latest/calrissian/main/#activate_logging","title":"activate_logging","text":"<pre><code>def activate_logging(\n    level\n)\n</code></pre>"},{"location":"api/latest/calrissian/main/#add_arguments","title":"add_arguments","text":"<pre><code>def add_arguments(\n    parser\n)\n</code></pre>"},{"location":"api/latest/calrissian/main/#add_custom_schema","title":"add_custom_schema","text":"<pre><code>def add_custom_schema(\n\n)\n</code></pre>"},{"location":"api/latest/calrissian/main/#flush_tees","title":"flush_tees","text":"<pre><code>def flush_tees(\n\n)\n</code></pre>"},{"location":"api/latest/calrissian/main/#get_log_level","title":"get_log_level","text":"<pre><code>def get_log_level(\n    parsed_args\n)\n</code></pre>"},{"location":"api/latest/calrissian/main/#handle_sigterm","title":"handle_sigterm","text":"<pre><code>def handle_sigterm(\n    signum,\n    frame\n)\n</code></pre>"},{"location":"api/latest/calrissian/main/#install_signal_handler","title":"install_signal_handler","text":"<pre><code>def install_signal_handler(\n\n)\n</code></pre> <p>Installs a handler to cleanup submitted pods on termination.</p> <p>This is installed on the main thread and calls there on termination. The CalrissianExecutor is multi-threaded and will submit jobs from other threads</p>"},{"location":"api/latest/calrissian/main/#install_tees","title":"install_tees","text":"<pre><code>def install_tees(\n    stdout_path=None,\n    stderr_path=None\n)\n</code></pre> <p>Reconnects stdout/stderr to <code>tee</code> processes via subprocess.PIPE that can write to user-supplied files</p> <p>https://stackoverflow.com/a/651718/595085</p> <p>Parameters:</p> Name Type Description Default stdout_path None optional path of file to tee standard output to None stderr_path None optional path of file to tee standard error to None <p>Returns:</p> Type Description None None"},{"location":"api/latest/calrissian/main/#main","title":"main","text":"<pre><code>def main(\n\n)\n</code></pre>"},{"location":"api/latest/calrissian/main/#parse_arguments","title":"parse_arguments","text":"<pre><code>def parse_arguments(\n    parser\n)\n</code></pre>"},{"location":"api/latest/calrissian/main/#print_version","title":"print_version","text":"<pre><code>def print_version(\n\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/","title":"Module calrissian.report","text":""},{"location":"api/latest/calrissian/report/#variables","title":"Variables","text":"<pre><code>SECONDS_PER_HOUR\n</code></pre> <pre><code>log\n</code></pre>"},{"location":"api/latest/calrissian/report/#functions","title":"Functions","text":""},{"location":"api/latest/calrissian/report/#default_serializer","title":"default_serializer","text":"<pre><code>def default_serializer(\n    obj\n)\n</code></pre> <p>Function to handle JSON serialization of objects that cannot be natively serialized</p> <p>Parameters:</p> Name Type Description Default obj None object to seralize None <p>Returns:</p> Type Description None JSON-compatible representation of object"},{"location":"api/latest/calrissian/report/#initialize_reporter","title":"initialize_reporter","text":"<pre><code>def initialize_reporter(\n    max_ram_mb,\n    max_cores\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#sum_ignore_none","title":"sum_ignore_none","text":"<pre><code>def sum_ignore_none(\n    iterable\n)\n</code></pre> <p>Sum function that skips None values</p> <p>Parameters:</p> Name Type Description Default iterable None An iterable to sum, may contain None or False values None <p>Returns:</p> Type Description None the sum of the numeric values"},{"location":"api/latest/calrissian/report/#write_report","title":"write_report","text":"<pre><code>def write_report(\n    filename\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#classes","title":"Classes","text":""},{"location":"api/latest/calrissian/report/#cpuparser","title":"CPUParser","text":"<pre><code>class CPUParser(\n    /,\n    *args,\n    **kwargs\n)\n</code></pre> <p>Converts Kubernetes CPU resource strings (e.g. 2, 200m) to floating point CPU quantities.</p>"},{"location":"api/latest/calrissian/report/#ancestors-in-mro","title":"Ancestors (in MRO)","text":"<ul> <li>calrissian.report.ResourceParser</li> </ul>"},{"location":"api/latest/calrissian/report/#class-variables","title":"Class variables","text":"<pre><code>kind\n</code></pre> <pre><code>suffixes\n</code></pre> <pre><code>url\n</code></pre>"},{"location":"api/latest/calrissian/report/#static-methods","title":"Static methods","text":""},{"location":"api/latest/calrissian/report/#parse","title":"parse","text":"<pre><code>def parse(\n    value\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#event","title":"Event","text":"<pre><code>class Event(\n    time,\n    type,\n    report\n)\n</code></pre> <p>Represents a start or finish event in a report, associated with its time.</p> <p>Event objects are intended to be sorted into a list and processed</p>"},{"location":"api/latest/calrissian/report/#class-variables_1","title":"Class variables","text":"<pre><code>FINISH\n</code></pre> <pre><code>START\n</code></pre>"},{"location":"api/latest/calrissian/report/#static-methods_1","title":"Static methods","text":""},{"location":"api/latest/calrissian/report/#finish_event","title":"finish_event","text":"<pre><code>def finish_event(\n    report\n)\n</code></pre> <p>Generate a finish event for the provided report at its finish time</p> <p>Parameters:</p> Name Type Description Default report None a TimedResourceReport None <p>Returns:</p> Type Description None an Event"},{"location":"api/latest/calrissian/report/#start_event","title":"start_event","text":"<pre><code>def start_event(\n    report\n)\n</code></pre> <p>Generate a start event for the provided report at its start time</p> <p>Parameters:</p> Name Type Description Default report None None <p>Returns:</p> Type Description None"},{"location":"api/latest/calrissian/report/#methods","title":"Methods","text":""},{"location":"api/latest/calrissian/report/#process","title":"process","text":"<pre><code>def process(\n    self,\n    processor\n)\n</code></pre> <p>Call the processor's process method with this Event's report and type</p> <p>Parameters:</p> Name Type Description Default processor None Object that implements .process(report, type) None <p>Returns:</p> Type Description None None"},{"location":"api/latest/calrissian/report/#maxparallelcpusprocessor","title":"MaxParallelCPUsProcessor","text":"<pre><code>class MaxParallelCPUsProcessor(\n\n)\n</code></pre> <p>Subclass of MaxParallelCountProcessor that counts cpus</p>"},{"location":"api/latest/calrissian/report/#ancestors-in-mro_1","title":"Ancestors (in MRO)","text":"<ul> <li>calrissian.report.MaxParallelCountProcessor</li> </ul>"},{"location":"api/latest/calrissian/report/#methods_1","title":"Methods","text":""},{"location":"api/latest/calrissian/report/#count_unit","title":"count_unit","text":"<pre><code>def count_unit(\n    self,\n    report\n)\n</code></pre> <p>The unit to count when processing an event. Override this based on the report to calculate different</p> <p>max parallel metrics</p> <p>Parameters:</p> Name Type Description Default report None Report for context (not used in base class) None <p>Returns:</p> Type Description None The value to count (here, 1)"},{"location":"api/latest/calrissian/report/#process_1","title":"process","text":"<pre><code>def process(\n    self,\n    report,\n    event_type\n)\n</code></pre> <p>Examine the event type, add/subtract the count unit, and recompute max</p> <p>Parameters:</p> Name Type Description Default report None The report to consider None event_type None Event.START or Event.FINISH None <p>Returns:</p> Type Description None None"},{"location":"api/latest/calrissian/report/#result","title":"result","text":"<pre><code>def result(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#maxparallelcountprocessor","title":"MaxParallelCountProcessor","text":"<pre><code>class MaxParallelCountProcessor(\n\n)\n</code></pre> <p>Simple processor to track the maximum parallel reports</p> <p>The process() method add count_unit (1) to self.count for each START and subtracts it for each FINISH, and recomputes self.max on each iteration</p>"},{"location":"api/latest/calrissian/report/#descendants","title":"Descendants","text":"<ul> <li>calrissian.report.MaxParallelCPUsProcessor</li> <li>calrissian.report.MaxParallelRAMProcessor</li> </ul>"},{"location":"api/latest/calrissian/report/#methods_2","title":"Methods","text":""},{"location":"api/latest/calrissian/report/#count_unit_1","title":"count_unit","text":"<pre><code>def count_unit(\n    self,\n    report\n)\n</code></pre> <p>The unit to count when processing an event. Override this based on the report to calculate different</p> <p>max parallel metrics</p> <p>Parameters:</p> Name Type Description Default report None Report for context (not used in base class) None <p>Returns:</p> Type Description None The value to count (here, 1)"},{"location":"api/latest/calrissian/report/#process_2","title":"process","text":"<pre><code>def process(\n    self,\n    report,\n    event_type\n)\n</code></pre> <p>Examine the event type, add/subtract the count unit, and recompute max</p> <p>Parameters:</p> Name Type Description Default report None The report to consider None event_type None Event.START or Event.FINISH None <p>Returns:</p> Type Description None None"},{"location":"api/latest/calrissian/report/#result_1","title":"result","text":"<pre><code>def result(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#maxparallelramprocessor","title":"MaxParallelRAMProcessor","text":"<pre><code>class MaxParallelRAMProcessor(\n\n)\n</code></pre> <p>Subclass of MaxParallelCountProcessor that counts ram_megabytes</p>"},{"location":"api/latest/calrissian/report/#ancestors-in-mro_2","title":"Ancestors (in MRO)","text":"<ul> <li>calrissian.report.MaxParallelCountProcessor</li> </ul>"},{"location":"api/latest/calrissian/report/#methods_3","title":"Methods","text":""},{"location":"api/latest/calrissian/report/#count_unit_2","title":"count_unit","text":"<pre><code>def count_unit(\n    self,\n    report\n)\n</code></pre> <p>The unit to count when processing an event. Override this based on the report to calculate different</p> <p>max parallel metrics</p> <p>Parameters:</p> Name Type Description Default report None Report for context (not used in base class) None <p>Returns:</p> Type Description None The value to count (here, 1)"},{"location":"api/latest/calrissian/report/#process_3","title":"process","text":"<pre><code>def process(\n    self,\n    report,\n    event_type\n)\n</code></pre> <p>Examine the event type, add/subtract the count unit, and recompute max</p> <p>Parameters:</p> Name Type Description Default report None The report to consider None event_type None Event.START or Event.FINISH None <p>Returns:</p> Type Description None None"},{"location":"api/latest/calrissian/report/#result_2","title":"result","text":"<pre><code>def result(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#memoryparser","title":"MemoryParser","text":"<pre><code>class MemoryParser(\n    /,\n    *args,\n    **kwargs\n)\n</code></pre> <p>Converts Kubernetes memory resource strings (e.g. 1Mi, 1G)to byte quantities</p>"},{"location":"api/latest/calrissian/report/#ancestors-in-mro_3","title":"Ancestors (in MRO)","text":"<ul> <li>calrissian.report.ResourceParser</li> </ul>"},{"location":"api/latest/calrissian/report/#class-variables_2","title":"Class variables","text":"<pre><code>kind\n</code></pre> <pre><code>suffixes\n</code></pre> <pre><code>url\n</code></pre>"},{"location":"api/latest/calrissian/report/#static-methods_2","title":"Static methods","text":""},{"location":"api/latest/calrissian/report/#parse_1","title":"parse","text":"<pre><code>def parse(\n    value\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#parse_to_megabytes","title":"parse_to_megabytes","text":"<pre><code>def parse_to_megabytes(\n    value\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#reporter","title":"Reporter","text":"<pre><code>class Reporter(\n    /,\n    *args,\n    **kwargs\n)\n</code></pre> <p>Singleton thread-safe reporting class</p>"},{"location":"api/latest/calrissian/report/#class-variables_3","title":"Class variables","text":"<pre><code>lock\n</code></pre> <pre><code>timeline_report\n</code></pre>"},{"location":"api/latest/calrissian/report/#static-methods_3","title":"Static methods","text":""},{"location":"api/latest/calrissian/report/#add_report","title":"add_report","text":"<pre><code>def add_report(\n    report\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#get_report","title":"get_report","text":"<pre><code>def get_report(\n\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#initialize","title":"initialize","text":"<pre><code>def initialize(\n    cores_allowed=0,\n    ram_mb_allowed=0\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#resourceparser","title":"ResourceParser","text":"<pre><code>class ResourceParser(\n    /,\n    *args,\n    **kwargs\n)\n</code></pre> <p>Base class for converting Kubernetes resources (memory/CPU) from strings to reportable numbers</p>"},{"location":"api/latest/calrissian/report/#descendants_1","title":"Descendants","text":"<ul> <li>calrissian.report.MemoryParser</li> <li>calrissian.report.CPUParser</li> </ul>"},{"location":"api/latest/calrissian/report/#class-variables_4","title":"Class variables","text":"<pre><code>kind\n</code></pre> <pre><code>suffixes\n</code></pre> <pre><code>url\n</code></pre>"},{"location":"api/latest/calrissian/report/#static-methods_4","title":"Static methods","text":""},{"location":"api/latest/calrissian/report/#parse_2","title":"parse","text":"<pre><code>def parse(\n    value\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#timedreport","title":"TimedReport","text":"<pre><code>class TimedReport(\n    name=None,\n    start_time=None,\n    finish_time=None\n)\n</code></pre> <p>Report on operations with a specific start time and finish time.</p>"},{"location":"api/latest/calrissian/report/#descendants_2","title":"Descendants","text":"<ul> <li>calrissian.report.TimedResourceReport</li> <li>calrissian.report.TimelineReport</li> </ul>"},{"location":"api/latest/calrissian/report/#methods_4","title":"Methods","text":""},{"location":"api/latest/calrissian/report/#elapsed_hours","title":"elapsed_hours","text":"<pre><code>def elapsed_hours(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#elapsed_seconds","title":"elapsed_seconds","text":"<pre><code>def elapsed_seconds(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#finish","title":"finish","text":"<pre><code>def finish(\n    self,\n    finish_time=None\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#start","title":"start","text":"<pre><code>def start(\n    self,\n    start_time=None\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#to_dict","title":"to_dict","text":"<pre><code>def to_dict(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#timedresourcereport","title":"TimedResourceReport","text":"<pre><code>class TimedResourceReport(\n    cpus=0,\n    ram_megabytes=0,\n    disk_megabytes=0,\n    exit_code=0,\n    node_selectors=None,\n    *args,\n    **kwargs\n)\n</code></pre> <p>Adds CPU, memory, and disk values to TimedReport, in order to calculate resource usage over the</p> <p>duration of the timed report. These values, by convention, are the kubernetes requested resources (not limits or actual).</p>"},{"location":"api/latest/calrissian/report/#ancestors-in-mro_4","title":"Ancestors (in MRO)","text":"<ul> <li>calrissian.report.TimedReport</li> </ul>"},{"location":"api/latest/calrissian/report/#static-methods_5","title":"Static methods","text":""},{"location":"api/latest/calrissian/report/#create","title":"create","text":"<pre><code>def create(\n    name,\n    completion_result,\n    disk_bytes\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#methods_5","title":"Methods","text":""},{"location":"api/latest/calrissian/report/#cpu_hours","title":"cpu_hours","text":"<pre><code>def cpu_hours(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#elapsed_hours_1","title":"elapsed_hours","text":"<pre><code>def elapsed_hours(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#elapsed_seconds_1","title":"elapsed_seconds","text":"<pre><code>def elapsed_seconds(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#finish_1","title":"finish","text":"<pre><code>def finish(\n    self,\n    finish_time=None\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#ram_megabyte_hours","title":"ram_megabyte_hours","text":"<pre><code>def ram_megabyte_hours(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#start_1","title":"start","text":"<pre><code>def start(\n    self,\n    start_time=None\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#to_dict_1","title":"to_dict","text":"<pre><code>def to_dict(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#timelinereport","title":"TimelineReport","text":"<pre><code>class TimelineReport(\n    cores_allowed=0,\n    ram_mb_allowed=0,\n    *args,\n    **kwargs\n)\n</code></pre> <p>A TimedReport that contains children.</p> <p>Can calculate totals and parallel statistics Automatically computes start_time and finish_time based on earliest/latest child reports</p>"},{"location":"api/latest/calrissian/report/#ancestors-in-mro_5","title":"Ancestors (in MRO)","text":"<ul> <li>calrissian.report.TimedReport</li> </ul>"},{"location":"api/latest/calrissian/report/#methods_6","title":"Methods","text":""},{"location":"api/latest/calrissian/report/#add_report_1","title":"add_report","text":"<pre><code>def add_report(\n    self,\n    report\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#elapsed_hours_2","title":"elapsed_hours","text":"<pre><code>def elapsed_hours(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#elapsed_seconds_2","title":"elapsed_seconds","text":"<pre><code>def elapsed_seconds(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#finish_2","title":"finish","text":"<pre><code>def finish(\n    self,\n    finish_time=None\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#max_parallel_cpus","title":"max_parallel_cpus","text":"<pre><code>def max_parallel_cpus(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#max_parallel_ram_megabytes","title":"max_parallel_ram_megabytes","text":"<pre><code>def max_parallel_ram_megabytes(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#max_parallel_tasks","title":"max_parallel_tasks","text":"<pre><code>def max_parallel_tasks(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#start_2","title":"start","text":"<pre><code>def start(\n    self,\n    start_time=None\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#to_dict_2","title":"to_dict","text":"<pre><code>def to_dict(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#total_cpu_hours","title":"total_cpu_hours","text":"<pre><code>def total_cpu_hours(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#total_disk_megabytes","title":"total_disk_megabytes","text":"<pre><code>def total_disk_megabytes(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#total_ram_megabyte_hours","title":"total_ram_megabyte_hours","text":"<pre><code>def total_ram_megabyte_hours(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/report/#total_tasks","title":"total_tasks","text":"<pre><code>def total_tasks(\n    self\n)\n</code></pre>"},{"location":"api/latest/calrissian/retry/","title":"Module calrissian.retry","text":""},{"location":"api/latest/calrissian/retry/#functions","title":"Functions","text":""},{"location":"api/latest/calrissian/retry/#retry_exponential_if_exception_type","title":"retry_exponential_if_exception_type","text":"<pre><code>def retry_exponential_if_exception_type(\n    exc_type,\n    logger\n)\n</code></pre> <p>Decorator function that returns the tenacity @retry decorator with our commonly-used config</p> <p>Parameters:</p> Name Type Description Default exc_type None Type of exception (or tuple of types) to retry if encountered None logger None A logger instance to send retry logs to None <p>Returns:</p> Type Description None Result of tenacity.retry decorator function"},{"location":"api/latest/calrissian/retry/#classes","title":"Classes","text":""},{"location":"api/latest/calrissian/retry/#retryparameters","title":"RetryParameters","text":"<pre><code>class RetryParameters(\n    /,\n    *args,\n    **kwargs\n)\n</code></pre>"},{"location":"api/latest/calrissian/retry/#class-variables","title":"Class variables","text":"<pre><code>ATTEMPTS\n</code></pre> <pre><code>MAX\n</code></pre> <pre><code>MIN\n</code></pre> <pre><code>MULTIPLIER\n</code></pre>"},{"location":"api/latest/calrissian/tool/","title":"Module calrissian.tool","text":""},{"location":"api/latest/calrissian/tool/#variables","title":"Variables","text":"<pre><code>log\n</code></pre>"},{"location":"api/latest/calrissian/tool/#functions","title":"Functions","text":""},{"location":"api/latest/calrissian/tool/#calrissian_make_tool","title":"calrissian_make_tool","text":"<pre><code>def calrissian_make_tool(\n    spec,\n    loadingContext\n)\n</code></pre> <p>Construct a Process object from a CWL document loaded into spec</p> <p>Parameters:</p> Name Type Description Default spec None None loadingContext None None <p>Returns:</p> Type Description None For CommandLineTools, return our specialized subclass that can run on k8s.For other types of documents, return the CWL default_make_tool"},{"location":"api/latest/calrissian/tool/#classes","title":"Classes","text":""},{"location":"api/latest/calrissian/tool/#calrissiancommandlinetool","title":"CalrissianCommandLineTool","text":"<pre><code>class CalrissianCommandLineTool(\n    toolpath_object: ruamel.yaml.comments.CommentedMap,\n    loadingContext: cwltool.context.LoadingContext\n)\n</code></pre> <p>Abstract CWL Process.</p>"},{"location":"api/latest/calrissian/tool/#ancestors-in-mro","title":"Ancestors (in MRO)","text":"<ul> <li>cwltool.command_line_tool.CommandLineTool</li> <li>cwltool.process.Process</li> <li>cwltool.utils.HasReqsHints</li> </ul>"},{"location":"api/latest/calrissian/tool/#static-methods","title":"Static methods","text":""},{"location":"api/latest/calrissian/tool/#make_path_mapper","title":"make_path_mapper","text":"<pre><code>def make_path_mapper(\n    reffiles: list[collections.abc.MutableMapping[str, typing.Union[NoneType, bool, str, int, float, collections.abc.MutableSequence['CWLOutputType'], collections.abc.MutableMapping[str, 'CWLOutputType']]]],\n    stagedir: str,\n    runtimeContext: cwltool.context.RuntimeContext,\n    separateDirs: bool\n) -&gt; cwltool.pathmapper.PathMapper\n</code></pre>"},{"location":"api/latest/calrissian/tool/#methods","title":"Methods","text":""},{"location":"api/latest/calrissian/tool/#checkrequirements","title":"checkRequirements","text":"<pre><code>def checkRequirements(\n    self,\n    rec: Union[collections.abc.MutableSequence[collections.abc.MutableMapping[str, Union[NoneType, bool, str, int, float, collections.abc.MutableSequence['CWLOutputType'], collections.abc.MutableMapping[str, 'CWLOutputType']]]], collections.abc.MutableMapping[str, Union[NoneType, bool, str, int, float, collections.abc.MutableSequence['CWLOutputType'], collections.abc.MutableMapping[str, 'CWLOutputType']]], NoneType, bool, str, int, float, collections.abc.MutableSequence['CWLOutputType'], collections.abc.MutableMapping[str, 'CWLOutputType']],\n    supported_process_requirements: collections.abc.Iterable[str]\n) -&gt; None\n</code></pre> <p>Check the presence of unsupported requirements.</p>"},{"location":"api/latest/calrissian/tool/#collect_output","title":"collect_output","text":"<pre><code>def collect_output(\n    self,\n    schema: collections.abc.MutableMapping[str, typing.Union[NoneType, bool, str, int, float, collections.abc.MutableSequence['CWLOutputType'], collections.abc.MutableMapping[str, 'CWLOutputType']]],\n    builder: cwltool.builder.Builder,\n    outdir: str,\n    fs_access: cwltool.stdfsaccess.StdFsAccess,\n    compute_checksum: bool = True\n) -&gt; Union[NoneType, bool, str, int, float, collections.abc.MutableSequence['CWLOutputType'], collections.abc.MutableMapping[str, 'CWLOutputType']]\n</code></pre>"},{"location":"api/latest/calrissian/tool/#collect_output_ports","title":"collect_output_ports","text":"<pre><code>def collect_output_ports(\n    self,\n    ports: ruamel.yaml.comments.CommentedSeq | set[collections.abc.MutableMapping[str, typing.Union[NoneType, bool, str, int, float, collections.abc.MutableSequence['CWLOutputType'], collections.abc.MutableMapping[str, 'CWLOutputType']]]],\n    builder: cwltool.builder.Builder,\n    outdir: str,\n    rcode: int,\n    compute_checksum: bool = True,\n    jobname: str = '',\n    readers: collections.abc.MutableMapping[str, collections.abc.MutableMapping[str, typing.Union[NoneType, bool, str, int, float, collections.abc.MutableSequence['CWLOutputType'], collections.abc.MutableMapping[str, 'CWLOutputType']]]] | None = None\n) -&gt; dict[str, typing.Union[NoneType, bool, str, int, float, collections.abc.MutableSequence['CWLOutputType'], collections.abc.MutableMapping[str, 'CWLOutputType']]]\n</code></pre>"},{"location":"api/latest/calrissian/tool/#evalresources","title":"evalResources","text":"<pre><code>def evalResources(\n    self,\n    builder: cwltool.builder.Builder,\n    runtimeContext: cwltool.context.RuntimeContext\n) -&gt; dict[str, int | float]\n</code></pre>"},{"location":"api/latest/calrissian/tool/#get_requirement","title":"get_requirement","text":"<pre><code>def get_requirement(\n    self,\n    feature: str\n) -&gt; tuple[collections.abc.MutableMapping[str, typing.Union[NoneType, bool, str, int, float, collections.abc.MutableSequence['CWLOutputType'], collections.abc.MutableMapping[str, 'CWLOutputType']]] | None, bool | None]\n</code></pre> <p>Retrieve the named feature from the requirements field, or the hints field.</p>"},{"location":"api/latest/calrissian/tool/#job","title":"job","text":"<pre><code>def job(\n    self,\n    job_order: collections.abc.MutableMapping[str, typing.Union[NoneType, bool, str, int, float, collections.abc.MutableSequence['CWLOutputType'], collections.abc.MutableMapping[str, 'CWLOutputType']]],\n    output_callbacks: collections.abc.Callable[[typing.Optional[collections.abc.MutableMapping[str, typing.Union[NoneType, bool, str, int, float, collections.abc.MutableSequence['CWLOutputType'], collections.abc.MutableMapping[str, 'CWLOutputType']]]], str], None],\n    runtimeContext: cwltool.context.RuntimeContext\n) -&gt; collections.abc.Generator[cwltool.job.JobBase | cwltool.command_line_tool.CallbackJob, None, None]\n</code></pre>"},{"location":"api/latest/calrissian/tool/#make_job_runner","title":"make_job_runner","text":"<pre><code>def make_job_runner(\n    self,\n    runtimeContext\n)\n</code></pre> <p>Construct a callable that can run a CommandLineTool</p> <p>Parameters:</p> Name Type Description Default runtimeContext None RuntimeContext object None <p>Returns:</p> Type Description None a callable that runs the job"},{"location":"api/latest/calrissian/tool/#updatepathmap","title":"updatePathmap","text":"<pre><code>def updatePathmap(\n    self,\n    outdir: str,\n    pathmap: cwltool.pathmapper.PathMapper,\n    fn: collections.abc.MutableMapping[str, typing.Union[NoneType, bool, str, int, float, collections.abc.MutableSequence['CWLOutputType'], collections.abc.MutableMapping[str, 'CWLOutputType']]]\n) -&gt; None\n</code></pre> <p>Update a PathMapper with a CWL File or Directory object.</p>"},{"location":"api/latest/calrissian/tool/#validate_hints","title":"validate_hints","text":"<pre><code>def validate_hints(\n    self,\n    avsc_names: schema_salad.avro.schema.Names,\n    hints: list[collections.abc.MutableMapping[str, typing.Union[NoneType, bool, str, int, float, collections.abc.MutableSequence['CWLOutputType'], collections.abc.MutableMapping[str, 'CWLOutputType']]]],\n    strict: bool\n) -&gt; None\n</code></pre> <p>Process the hints field.</p>"},{"location":"api/latest/calrissian/tool/#visit","title":"visit","text":"<pre><code>def visit(\n    self,\n    op: collections.abc.Callable[[ruamel.yaml.comments.CommentedMap], None]\n) -&gt; None\n</code></pre>"},{"location":"api/latest/calrissian/tool/#calrissiancommandlinetoolexception","title":"CalrissianCommandLineToolException","text":"<pre><code>class CalrissianCommandLineToolException(\n    /,\n    *args,\n    **kwargs\n)\n</code></pre> <p>Common base class for all exceptions</p>"},{"location":"api/latest/calrissian/tool/#ancestors-in-mro_1","title":"Ancestors (in MRO)","text":"<ul> <li>builtins.BaseException</li> </ul>"},{"location":"api/latest/calrissian/tool/#class-variables","title":"Class variables","text":"<pre><code>args\n</code></pre>"},{"location":"api/latest/calrissian/tool/#methods_1","title":"Methods","text":""},{"location":"api/latest/calrissian/tool/#with_traceback","title":"with_traceback","text":"<pre><code>def with_traceback(\n    ...\n)\n</code></pre> <p>Exception.with_traceback(tb) --</p> <p>set self.traceback to tb and return self.</p>"},{"location":"api/latest/calrissian/version/","title":"Module calrissian.version","text":""},{"location":"api/latest/calrissian/version/#functions","title":"Functions","text":""},{"location":"api/latest/calrissian/version/#calrissian_version","title":"calrissian_version","text":"<pre><code>def calrissian_version(\n\n)\n</code></pre>"},{"location":"api/latest/calrissian/version/#cwltool_version","title":"cwltool_version","text":"<pre><code>def cwltool_version(\n\n)\n</code></pre>"},{"location":"api/latest/calrissian/version/#package_version","title":"package_version","text":"<pre><code>def package_version(\n    package_name\n)\n</code></pre>"},{"location":"api/latest/calrissian/version/#version","title":"version","text":"<pre><code>def version(\n\n)\n</code></pre>"},{"location":"conformance/1.0.2/","title":"1.0.2","text":""},{"location":"conformance/1.0.2/#conformance-tests-for-cwl-v10-for-the-latest-release","title":"Conformance tests for CWL v1.0 for the latest release","text":""},{"location":"conformance/1.0.2/#classes","title":"Classes","text":""},{"location":"conformance/1.0.2/#required-features","title":"Required features","text":""},{"location":"conformance/1.0.2/#optional-features","title":"Optional features","text":""},{"location":"conformance/1.0.2/#conformance-output","title":"Conformance output","text":"<p>result-v1.0.txt</p>"},{"location":"conformance/1.1.0/","title":"1.1.0","text":""},{"location":"conformance/1.1.0/#conformance-tests-for-cwl-v11-for-the-latest-release","title":"Conformance tests for CWL v1.1 for the latest release","text":""},{"location":"conformance/1.1.0/#classes","title":"Classes","text":""},{"location":"conformance/1.1.0/#required-features","title":"Required features","text":""},{"location":"conformance/1.1.0/#optional-features","title":"Optional features","text":""},{"location":"conformance/1.2.0/","title":"1.2.0","text":""},{"location":"conformance/1.2.0/#conformance-tests-for-cwl-v120-for-the-latest-release","title":"Conformance tests for CWL v1.2.0 for the latest release","text":""},{"location":"conformance/1.2.0/#classes","title":"Classes","text":""},{"location":"conformance/1.2.0/#required-features","title":"Required features","text":""},{"location":"conformance/1.2.0/#optional-features","title":"Optional features","text":""},{"location":"conformance/1.2.1/","title":"1.2.1","text":""},{"location":"conformance/1.2.1/#conformance-tests-for-cwl-v121-proposed-for-the-latest-release","title":"Conformance tests for CWL v1.2.1 (proposed) for the latest release","text":""},{"location":"conformance/1.2.1/#classes","title":"Classes","text":""},{"location":"conformance/1.2.1/#required-features","title":"Required features","text":""},{"location":"conformance/1.2.1/#optional-features","title":"Optional features","text":""}]}